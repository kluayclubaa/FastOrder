"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[583],{2583:(e,t,n)=>{n.d(t,{A:()=>g});var a=n(5155),r=n(2115),l=n(1857),o=n(1788),s=n(1304),i=n(4357),c=n(6683),d=n(2525),u=n(5610),m=n(6203),x=n(5695);function g(){let[e,t]=(0,r.useState)(null),[n,g]=(0,r.useState)(""),[b,h]=(0,r.useState)(""),[p,f]=(0,r.useState)(""),[v,j]=(0,r.useState)(300),[y,N]=(0,r.useState)([]),[w,C]=(0,r.useState)(!1),[S,z]=(0,r.useState)(null),k=(0,r.useRef)(null),R=(0,x.useRouter)(),I=e=>{try{let t=localStorage.getItem("qrcodes_".concat(e));if(t){let e=JSON.parse(t).map(e=>({...e,createdAt:"string"==typeof e.createdAt?e.createdAt:new Date(e.createdAt).toISOString()}));N(e)}}catch(e){console.error("Error loading saved QR codes:",e),N([])}},A=(e,t)=>{try{localStorage.setItem("qrcodes_".concat(t),JSON.stringify(e))}catch(e){console.error("Error saving QR codes:",e)}};(0,r.useEffect)(()=>{let e=(0,m.hg)(u.j2,e=>{e?(t(e.uid),I(e.uid)):R.push("/login")});return()=>e()},[R]);let Q=(t,a,r)=>{if(!e)return"";let l=t||n,o=a||b,s=r||p;if(!l)return"";let i=window.location.origin,c=o?"".concat(o).concat(l):l,d="".concat(i,"/order?id=").concat(e,"&table=").concat(c);return s&&(d+="&info=".concat(encodeURIComponent(s))),d},E=t=>{if(!e)return;let n=y.filter(e=>e.id!==t);N(n),A(n,e),(null==S?void 0:S.id)===t&&(C(!1),z(null))},D=e=>{g(e.table),h(e.zone),f(e.additionalInfo||""),z(e),C(!0)},q=()=>{S&&navigator.clipboard.writeText(S.url).then(()=>{alert("คัดลอก URL สำเร็จ")}).catch(e=>{console.error("Error copying URL: ",e);let t=document.createElement("textarea");t.value=S.url,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),alert("คัดลอก URL สำเร็จ")})};return(0,a.jsxs)("div",{className:"max-w-6xl mx-auto p-4",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-6",children:"สร้าง QR Code สำหรับโต๊ะอาหาร"}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-8",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"โซน (ไม่บังคับ)"}),(0,a.jsxs)("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:b,onChange:e=>h(e.target.value),children:[(0,a.jsx)("option",{value:"",children:"ไม่ระบุโซน"}),(0,a.jsx)("option",{value:"A",children:"โซน A"}),(0,a.jsx)("option",{value:"B",children:"โซน B"}),(0,a.jsx)("option",{value:"C",children:"โซน C"}),(0,a.jsx)("option",{value:"D",children:"โซน D"}),(0,a.jsx)("option",{value:"E",children:"โซน E"}),(0,a.jsx)("option",{value:"F",children:"โซน F"})]})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"หมายเลขโต๊ะ *"}),(0,a.jsx)("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"เช่น 1, 2, 3",value:n,onChange:e=>g(e.target.value),required:!0})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ข้อมูลเพิ่มเติม (ไม่บังคับ)"}),(0,a.jsx)("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"เช่น ชื่อร้าน, ข้อความต้อนรับ",value:p,onChange:e=>f(e.target.value)})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ขนาด QR Code"}),(0,a.jsxs)("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:v,onChange:e=>j(Number(e.target.value)),children:[(0,a.jsx)("option",{value:"200",children:"เล็ก (200x200 px)"}),(0,a.jsx)("option",{value:"300",children:"กลาง (300x300 px)"}),(0,a.jsx)("option",{value:"400",children:"ใหญ่ (400x400 px)"}),(0,a.jsx)("option",{value:"500",children:"ใหญ่มาก (500x500 px)"})]})]}),(0,a.jsx)("button",{onClick:()=>{if(!e||!n)return;let t=Q(),a=b?"".concat(b).concat(n):n,r=y.find(e=>e.table===n&&e.zone===b);if(r){let n={...r,url:t,additionalInfo:p,createdAt:new Date().toISOString()},a=y.map(e=>e.id===r.id?n:e);N(a),z(n),A(a,e)}else{let r={id:"".concat(e,"_").concat(a,"_").concat(Date.now()),table:n,zone:b,url:t,additionalInfo:p,createdAt:new Date().toISOString()},l=[r,...y];N(l),z(r),A(l,e)}C(!0)},disabled:!n,className:"w-full py-3 rounded-md font-medium ".concat(n?"bg-blue-600 hover:bg-blue-700 text-white":"bg-gray-300 cursor-not-allowed text-gray-500"),children:y.find(e=>e.table===n&&e.zone===b)?"อัปเดต QR Code":"สร้าง QR Code"})]}),(0,a.jsx)("div",{className:"flex flex-col items-center justify-center",children:w&&S&&(0,a.jsxs)("div",{className:"text-center",ref:k,children:[(0,a.jsxs)("div",{className:"mb-3 font-medium text-lg",children:["โต๊ะ ",S.zone,S.table]}),S.additionalInfo&&(0,a.jsx)("div",{className:"mb-3 text-sm text-gray-600",children:S.additionalInfo}),(0,a.jsx)(l.h,{value:S.url,size:v,level:"H",includeMargin:!0,className:"mx-auto border border-gray-200 rounded-lg"}),(0,a.jsxs)("div",{className:"mt-4 flex flex-wrap justify-center gap-2",children:[(0,a.jsxs)("button",{onClick:()=>{if(!k.current||!S)return;let e=k.current.querySelector("svg");if(!e)return;let t=new XMLSerializer().serializeToString(e),n=document.createElement("canvas"),a=n.getContext("2d"),r=new Image;n.width=v,n.height=v,r.onload=()=>{if(a){a.fillStyle="white",a.fillRect(0,0,v,v),a.drawImage(r,0,0);let e=n.toDataURL("image/png"),t=document.createElement("a"),l=S.zone?"".concat(S.zone).concat(S.table):S.table;t.download="qrcode-table-".concat(l,".png"),t.href=e,t.click()}},r.src="data:image/svg+xml;base64,".concat(btoa(t))},className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-md text-sm hover:bg-blue-700",children:[(0,a.jsx)(o.A,{className:"h-4 w-4 mr-1"})," บันทึก"]}),(0,a.jsxs)("button",{onClick:()=>{if(!S||!k.current)return;let e=S.zone?"".concat(S.zone).concat(S.table):S.table,t=k.current.querySelector("svg");if(!t)return;let n=window.open("","_blank");if(!n)return;let a=new XMLSerializer().serializeToString(t);n.document.write("\n      <html>\n        <head>\n          <title>QR Code โต๊ะ ".concat(e,'</title>\n          <style>\n            body {\n              font-family: \'Sarabun\', Arial, sans-serif;\n              text-align: center;\n              padding: 20px;\n              margin: 0;\n            }\n            .qr-container {\n              margin: 20px auto;\n              max-width: 400px;\n            }\n            .table-info {\n              font-size: 28px;\n              font-weight: bold;\n              margin-bottom: 10px;\n              color: #333;\n            }\n            .instructions {\n              font-size: 18px;\n              margin-bottom: 20px;\n              color: #666;\n            }\n            .qr-code {\n              margin: 20px 0;\n            }\n            .url {\n              font-size: 10px;\n              word-break: break-all;\n              margin-top: 15px;\n              color: #888;\n            }\n            .additional-info {\n              font-size: 14px;\n              margin-top: 10px;\n              color: #555;\n            }\n            @media print {\n              .no-print {\n                display: none;\n              }\n              body {\n                margin: 0;\n                padding: 10px;\n              }\n            }\n          </style>\n        </head>\n        <body>\n          <div class="qr-container">\n            <div class="table-info">โต๊ะ ').concat(e,'</div>\n            <div class="instructions">สแกน QR Code เพื่อสั่งอาหาร</div>\n            ').concat(S.additionalInfo?'<div class="additional-info">'.concat(S.additionalInfo,"</div>"):"",'\n            <div class="qr-code">\n              ').concat(a,'\n            </div>\n            <div class="url">').concat(S.url,'</div>\n            <button class="no-print" style="margin-top: 20px; padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer;" onclick="window.print()">พิมพ์</button>\n          </div>\n        </body>\n      </html>\n    ')),n.document.close(),n.onload=()=>{setTimeout(()=>{n.print()},250)}},className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-md text-sm hover:bg-green-700",children:[(0,a.jsx)(s.A,{className:"h-4 w-4 mr-1"})," พิมพ์"]}),(0,a.jsxs)("button",{onClick:q,className:"flex items-center px-4 py-2 bg-purple-600 text-white rounded-md text-sm hover:bg-purple-700",children:[(0,a.jsx)(i.A,{className:"h-4 w-4 mr-1"})," คัดลอก URL"]}),(0,a.jsxs)("button",{onClick:()=>{if(!S)return;let e=S.zone?"".concat(S.zone).concat(S.table):S.table;navigator.share?navigator.share({title:"QR Code สำหรับโต๊ะ ".concat(e),text:"สแกน QR Code นี้เพื่อสั่งอาหาร",url:S.url}).catch(e=>{console.error("Error sharing: ",e)}):q()},className:"flex items-center px-4 py-2 bg-orange-600 text-white rounded-md text-sm hover:bg-orange-700",children:[(0,a.jsx)(c.A,{className:"h-4 w-4 mr-1"})," แชร์"]})]})]})})]})}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-bold",children:["QR Code ทั้งหมด (",y.length,")"]}),y.length>0&&(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"จัดเก็บอย่างถาวรในเครื่องของคุณ"})]}),0===y.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"bg-gray-100 p-6 rounded-full inline-block mb-4",children:(0,a.jsx)(l.h,{value:"placeholder",size:60,className:"text-gray-400"})}),(0,a.jsx)("p",{className:"text-gray-500 text-lg",children:"ยังไม่มี QR Code ที่สร้างไว้"}),(0,a.jsx)("p",{className:"text-gray-400 text-sm mt-2",children:"สร้าง QR Code แรกของคุณด้านบน"})]}):(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:y.map(e=>(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 text-center hover:shadow-md transition-shadow",children:[(0,a.jsxs)("div",{className:"mb-2 font-medium text-lg",children:["โต๊ะ ",e.zone,e.table]}),e.additionalInfo&&(0,a.jsx)("div",{className:"mb-2 text-xs text-gray-600 truncate",children:e.additionalInfo}),(0,a.jsx)(l.h,{value:e.url,size:120,level:"M",includeMargin:!0,className:"mx-auto mb-3"}),(0,a.jsx)("div",{className:"text-xs text-gray-500 mb-3",children:new Date(e.createdAt).toLocaleDateString("th-TH",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}),(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)("button",{onClick:()=>D(e),className:"flex-1 px-3 py-1.5 bg-blue-50 text-blue-700 rounded-md text-sm hover:bg-blue-100",children:"ดูรายละเอียด"}),(0,a.jsx)("button",{onClick:()=>E(e.id),className:"px-2 py-1.5 bg-red-50 text-red-600 rounded-md text-sm hover:bg-red-100",title:"ลบ QR Code",children:(0,a.jsx)(d.A,{className:"h-4 w-4"})})]})]},e.id))})]})]})}},5610:(e,t,n)=>{n.d(t,{H9:()=>l.H9,db:()=>c,j2:()=>i,x7:()=>l.x7});var a=n(3915),r=n(6203),l=n(5317),o=n(858);let s=(0,a.Wp)({apiKey:"AIzaSyBdnWr8bkOF5oP2gSsjo9pXbrZbJO-QzDc",authDomain:"fastorder-8f143.firebaseapp.com",projectId:"fastorder-8f143",storageBucket:"fastorder-8f143.firebasestorage.app",messagingSenderId:"827965800193",appId:"1:827965800193:web:1d9ff91b5f6adb90bf6500",measurementId:"G-2LXXJM6W59"}),i=(0,r.xI)(s),c=(0,l.aU)(s);new r.HF,(0,o.c7)(s)}}]);