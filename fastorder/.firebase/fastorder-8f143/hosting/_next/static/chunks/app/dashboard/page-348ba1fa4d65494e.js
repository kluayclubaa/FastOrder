(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{4907:(e,s,t)=>{Promise.resolve().then(t.bind(t,8169))},5589:(e,s,t)=>{"use strict";t.d(s,{ZD:()=>n,bi:()=>l,mQ:()=>c,mn:()=>d,z0:()=>i});var r=t(5610),a=t(5317);let l=async(e,s)=>{try{let t=(0,a.H9)((0,a.rJ)(r.db,"restaurants",e,"members")),l={...s,points:0,totalSpent:0,joinDate:(0,a.O5)(),lastVisit:(0,a.O5)(),tier:"bronze",restaurantId:e};return await (0,a.BN)(t,l),t.id}catch(e){throw console.error("Error creating member:",e),e}},n=async(e,s)=>{try{let t=(0,a.rJ)(r.db,"restaurants",e,"members"),l=(0,a.P)(t,(0,a._M)("phone","==",s)),n=await (0,a.GG)(l);if(!n.empty){let e=n.docs[0];return{id:e.id,...e.data()}}return null}catch(e){throw console.error("Error finding member:",e),e}},i=async(e,s,t,l,n)=>{try{let i=(0,a.H9)(r.db,"restaurants",e,"members",s);await (0,a.mZ)(i,{points:(0,a.GV)(t),lastVisit:(0,a.O5)()});let c=(0,a.rJ)(r.db,"restaurants",e,"point_transactions");return await (0,a.gS)(c,{memberId:s,type:"earn",points:t,orderId:l,description:n||"ได้รับแต้มจากการสั่งอาหาร",createdAt:(0,a.O5)()}),!0}catch(e){throw console.error("Error adding points:",e),e}},c=e=>Math.floor(e),d=async(e,s,t)=>{let l="bronze";t>=1e4?l="platinum":t>=5e3?l="gold":t>=2e3&&(l="silver");let n=(0,a.H9)(r.db,"restaurants",e,"members",s);await (0,a.mZ)(n,{tier:l,totalSpent:t})}},8169:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>ei});var r=t(5155),a=t(2115),l=t(5868),n=t(5747),i=t(2713),c=t(4186),d=t(7434),o=t(3109),m=t(8564),x=t(9074),u=t(4783),h=t(3861),p=t(4416),g=t(7939),b=t(6308),j=t(7580),y=t(238),f=t(381),N=t(4835),v=t(6474),w=t(5937),A=t(9420),k=t(8883),C=t(4631),S=t(4229),D=t(5695),E=t(5610),P=t(5317),F=t(6203),O=t(4616),T=t(7924),U=t(6932),_=t(1492),R=t(858);function M(e){let{restaurantId:s,onMenuUpdate:t}=e,[l,n]=(0,a.useState)([]),[i,c]=(0,a.useState)(!1),[d,o]=(0,a.useState)(null),[x,u]=(0,a.useState)({show:!1,message:"",type:""}),[h,g]=(0,a.useState)(""),[b,j]=(0,a.useState)("all"),[y,f]=(0,a.useState)("name"),[N,v]=(0,a.useState)("asc"),[w,A]=(0,a.useState)([]),[k,D]=(0,a.useState)(null),[M,L]=(0,a.useState)(!1),[I,H]=(0,a.useState)({name:"",description:"",price:"",category:"",isAvailable:!0,isRecommended:!1,recommendedTime:"all",imageUrl:"",imageFile:null,options:[]}),[q,z]=(0,a.useState)({name:"",price:""}),J=s||d;(0,a.useEffect)(()=>{if(s)Q(s);else{let e=(0,F.hg)(E.j2,e=>{e&&(o(e.uid),Q(e.uid))});return()=>e()}},[s]);let Q=e=>{try{c(!0);let s=(0,P.P)((0,P.rJ)(E.db,"users",e,"menu"),(0,P.My)(y,"asc"===N?"asc":"desc"));return(0,P.aQ)(s,e=>{let s=[],r=new Set;e.forEach(e=>{let t=e.data();s.push({id:e.id,...t}),t.category&&r.add(t.category)}),n(s),A(Array.from(r)),c(!1),t&&t(s)},e=>{console.error("Error in menu real-time listener:",e),es("ไม่สามารถโหลดเมนูได้","error"),c(!1)})}catch(e){return console.error("Error setting up menu listener:",e),es("ไม่สามารถโหลดเมนูได้","error"),c(!1),()=>{}}},G=async e=>{if(!J||!e)return"";let s=(0,R.c7)(),t=e.name.split(".").pop(),r="menu_".concat(Date.now(),".").concat(t),a=(0,R.KR)(s,"users/".concat(J,"/menu/").concat(r));return await (0,R.D)(a,e),await (0,R.qk)(a)},Z=async()=>{if(J){if(!I.name||!I.price)return void es("กรุณากรอกชื่อเมนูและราคา","error");try{c(!0);let e="";I.imageFile&&(e=await G(I.imageFile));let s={name:I.name,description:I.description,price:Number.parseFloat(I.price),category:I.category,isAvailable:I.isAvailable,isRecommended:I.isRecommended,recommendedTime:I.recommendedTime,imageUrl:e,options:I.options,createdAt:(0,P.O5)()};await (0,P.gS)((0,P.rJ)(E.db,"users",J,"menu"),s),W(),L(!1),es("เพิ่มเมนูสำเร็จ","success")}catch(e){console.error("Error adding menu item:",e),es("ไม่สามารถเพิ่มเมนูได้","error")}finally{c(!1)}}},K=async()=>{if(J&&k)try{c(!0);let e=I.imageUrl;if(I.imageFile){if(k.imageUrl&&k.imageUrl.includes("firebase"))try{let e=(0,R.c7)(),s=(0,R.KR)(e,k.imageUrl);await (0,R.XR)(s)}catch(e){console.error("Error deleting old image:",e)}e=await G(I.imageFile)}let s={name:I.name,description:I.description,price:Number.parseFloat(I.price),category:I.category,isAvailable:I.isAvailable,isRecommended:I.isRecommended,recommendedTime:I.recommendedTime,imageUrl:e,options:I.options,updatedAt:(0,P.O5)()};await (0,P.mZ)((0,P.H9)(E.db,"users",J,"menu",k.id),s),W(),L(!1),es("อัปเดตเมนูสำเร็จ","success")}catch(e){console.error("Error updating menu item:",e),es("ไม่สามารถอัปเดตเมนูได้","error")}finally{c(!1)}},B=async e=>{if(J&&confirm("คุณต้องการลบเมนูนี้ใช่หรือไม่?"))try{c(!0);let s=await (0,P.GG)((0,P.P)((0,P.rJ)(E.db,"users",J,"menu"),(0,P._M)("__name__","==",e)));if(!s.empty){let e=s.docs[0].data();if(e.imageUrl&&e.imageUrl.includes("firebase"))try{let s=(0,R.c7)(),t=(0,R.KR)(s,e.imageUrl);await (0,R.XR)(t)}catch(e){console.error("Error deleting image:",e)}}await (0,P.kd)((0,P.H9)(E.db,"users",J,"menu",e)),es("ลบเมนูสำเร็จ","success")}catch(e){console.error("Error deleting menu item:",e),es("ไม่สามารถลบเมนูได้","error")}finally{c(!1)}},V=async(e,s)=>{if(J)try{await (0,P.mZ)((0,P.H9)(E.db,"users",J,"menu",e),{isAvailable:!s,updatedAt:(0,P.O5)()}),es("อัปเดตสถานะสำเร็จ","success")}catch(e){console.error("Error toggling availability:",e),es("ไม่สามารถอัปเดตสถานะได้","error")}},X=async(e,s)=>{if(J)try{await (0,P.mZ)((0,P.H9)(E.db,"users",J,"menu",e),{isRecommended:!s,updatedAt:(0,P.O5)()}),es("อัปเดตสถานะสำเร็จ","success")}catch(e){console.error("Error toggling recommended status:",e),es("ไม่สามารถอัปเดตสถานะได้","error")}},W=()=>{H({name:"",description:"",price:"",category:"",isAvailable:!0,isRecommended:!1,recommendedTime:"all",imageUrl:"",imageFile:null,options:[]}),D(null)},Y=e=>{D(e),H({name:e.name,description:e.description||"",price:e.price.toString(),category:e.category||"",isAvailable:e.isAvailable,isRecommended:e.isRecommended,recommendedTime:e.recommendedTime||"all",imageUrl:e.imageUrl||"",imageFile:null,options:e.options||[]}),L(!0)},$=()=>{W(),L(!0)},ee=e=>{let{name:s,value:t,type:r}=e.target;if("checkbox"===r){let t=e.target;H({...I,[s]:t.checked})}else H({...I,[s]:t})},es=(e,s)=>{u({show:!0,message:e,type:s}),setTimeout(()=>{u({show:!1,message:"",type:""})},3e3)},et=l.filter(e=>{let s=e.name.toLowerCase().includes(h.toLowerCase())||e.description.toLowerCase().includes(h.toLowerCase()),t="all"===b||e.category===b;return s&&t}),er=e=>{y===e?v("asc"===N?"desc":"asc"):(f(e),v("asc"))},ea=e=>{H({...I,options:I.options.filter(s=>s.id!==e)})};return(0,r.jsxs)("div",{className:"container mx-auto px-4 py-6",children:[(0,r.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-1",children:"จัดการเมนู"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:"เพิ่มและจัดการเมนูของร้านคุณ"})]}),(0,r.jsxs)("button",{onClick:$,className:"mt-4 md:mt-0 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center",children:[(0,r.jsx)(O.A,{className:"h-4 w-4 mr-2"}),"เพิ่มเมนูใหม่"]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[(0,r.jsx)("div",{className:"p-4 border-b border-gray-200",children:(0,r.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,r.jsxs)("div",{className:"relative flex-1",children:[(0,r.jsx)(T.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,r.jsx)("input",{type:"text",placeholder:"ค้นหาเมนู...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:h,onChange:e=>g(e.target.value)})]}),(0,r.jsx)("div",{className:"flex gap-2",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(U.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,r.jsxs)("select",{className:"pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:b,onChange:e=>j(e.target.value),children:[(0,r.jsx)("option",{value:"all",children:"ทุกหมวดหมู่"}),w.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]})]})})]})}),i&&0===l.length?(0,r.jsx)("div",{className:"flex justify-center items-center p-8",children:(0,r.jsx)(C.A,{className:"h-8 w-8 text-blue-500 animate-spin"})}):0===l.length?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 px-4 text-center",children:[(0,r.jsx)("button",{onClick:$,className:"bg-gray-100 p-4 rounded-full mb-4",children:(0,r.jsx)(O.A,{className:"h-8 w-8 text-gray-400"})}),(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"ยังไม่มีเมนู"}),(0,r.jsx)("p",{className:"text-sm text-gray-500 max-w-md mb-6",children:"เพิ่มเมนูอาหารของร้านคุณเพื่อให้ลูกค้าสั่งได้"})]}):(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>er("name"),children:(0,r.jsxs)("div",{className:"flex items-center",children:["เมนู","name"===y&&(0,r.jsx)(_.A,{className:"ml-1 h-4 w-4 text-gray-400"})]})}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>er("price"),children:(0,r.jsxs)("div",{className:"flex items-center",children:["ราคา","price"===y&&(0,r.jsx)(_.A,{className:"ml-1 h-4 w-4 text-gray-400"})]})}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>er("category"),children:(0,r.jsxs)("div",{className:"flex items-center",children:["หมวดหมู่","category"===y&&(0,r.jsx)(_.A,{className:"ml-1 h-4 w-4 text-gray-400"})]})}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"สถานะ"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"แนะนำ"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"จัดการ"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:et.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex items-center",children:[e.imageUrl?(0,r.jsx)("img",{src:e.imageUrl||"/placeholder.svg",alt:e.name,className:"w-10 h-10 rounded-md object-cover mr-3"}):(0,r.jsx)("div",{className:"w-10 h-10 rounded-md bg-gray-200 flex items-center justify-center mr-3",children:(0,r.jsx)("span",{className:"text-xs text-gray-500",children:"ไม่มีรูป"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),e.description&&(0,r.jsx)("div",{className:"text-xs text-gray-500 max-w-xs truncate",children:e.description})]})]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"text-sm text-gray-900",children:["฿",e.price.toFixed(2)]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-gray-900",children:e.category||"-"})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("button",{onClick:()=>V(e.id,e.isAvailable),className:"px-2 py-1 rounded-full text-xs font-medium ".concat(e.isAvailable?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.isAvailable?"พร้อมขาย":"หมด"})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("button",{onClick:()=>X(e.id,e.isRecommended),className:"px-2 py-1 rounded-full text-xs font-medium flex items-center ".concat(e.isRecommended?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:[e.isRecommended&&(0,r.jsx)(m.A,{className:"h-3 w-3 mr-1"}),e.isRecommended?"แนะนำ":"ไม่แนะนำ"]})}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[(0,r.jsx)("button",{onClick:()=>Y(e),className:"text-blue-600 hover:text-blue-900 mr-3",children:"แก้ไข"}),(0,r.jsx)("button",{onClick:()=>B(e.id),className:"text-red-600 hover:text-red-900",children:"ลบ"})]})]},e.id))})]})})]}),M&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:(0,r.jsx)("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h3",{className:"text-xl font-bold",children:k?"แก้ไขเมนู":"เพิ่มเมนูใหม่"}),(0,r.jsx)("button",{className:"text-gray-500 hover:text-gray-700",onClick:()=>L(!1),children:(0,r.jsx)(p.A,{className:"h-5 w-5"})})]}),(0,r.jsx)("div",{className:"grid grid-cols-1 gap-6",children:(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ชื่อเมนู *"}),(0,r.jsx)("input",{type:"text",name:"name",value:I.name,onChange:ee,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"ชื่อเมนู",required:!0})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ราคา (บาท) *"}),(0,r.jsx)("input",{type:"number",name:"price",value:I.price,onChange:ee,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00",min:"0",step:"0.01",required:!0})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"หมวดหมู่"}),(0,r.jsxs)("select",{name:"category",value:I.category,onChange:ee,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"",disabled:!0,children:"เลือกหมวดหมู่"}),(0,r.jsx)("option",{value:"อาหารจานเดียว",children:"อาหารจานเดียว"}),(0,r.jsx)("option",{value:"กับข้าว",children:"กับข้าว"}),(0,r.jsx)("option",{value:"เครื่องดื่ม",children:"เครื่องดื่ม"}),(0,r.jsx)("option",{value:"ของหวาน",children:"ของหวาน"}),(0,r.jsx)("option",{value:"อื่นๆ",children:"อื่นๆ"}),w.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"รายละเอียด"}),(0,r.jsx)("textarea",{name:"description",value:I.description,onChange:ee,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"รายละเอียดเมนู",rows:3})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"รูปภาพเมนู"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsx)("div",{children:I.imageUrl?(0,r.jsxs)("div",{className:"relative w-full h-40 border rounded-md overflow-hidden",children:[(0,r.jsx)("img",{src:I.imageUrl||"/placeholder.svg",alt:"รูปภาพเมนู",className:"w-full h-full object-cover"}),(0,r.jsx)("button",{type:"button",onClick:()=>H({...I,imageUrl:"",imageFile:null}),className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600",children:(0,r.jsx)(p.A,{className:"h-4 w-4"})})]}):(0,r.jsxs)("label",{className:"cursor-pointer flex flex-col items-center justify-center w-full h-40 border-2 border-dashed border-gray-300 rounded-md hover:bg-gray-50",children:[(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[(0,r.jsx)("svg",{className:"w-10 h-10 text-gray-400 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),(0,r.jsx)("p",{className:"mb-2 text-sm text-gray-500",children:(0,r.jsx)("span",{className:"font-semibold",children:"อัพโหลดรูป"})}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"PNG, JPG หรือ GIF (สูงสุด 10MB)"})]}),(0,r.jsx)("input",{type:"file",accept:"image/*",className:"hidden",onChange:e=>{if(e.target.files&&e.target.files[0]){let s=e.target.files[0];H({...I,imageFile:s});let t=new FileReader;t.onload=e=>{var s;(null==(s=e.target)?void 0:s.result)&&H(s=>{var t;return{...s,imageUrl:null==(t=e.target)?void 0:t.result}})},t.readAsDataURL(s)}}})]})}),(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",id:"isAvailable",name:"isAvailable",checked:I.isAvailable,onChange:e=>H({...I,isAvailable:e.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,r.jsx)("label",{htmlFor:"isAvailable",className:"ml-2 text-sm text-gray-700",children:"พร้อมขาย"})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",id:"isRecommended",name:"isRecommended",checked:I.isRecommended,onChange:e=>H({...I,isRecommended:e.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,r.jsx)("label",{htmlFor:"isRecommended",className:"ml-2 text-sm text-gray-700",children:"แนะนำ"})]}),I.isRecommended&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ช่วงเวลาที่แนะนำ"}),(0,r.jsxs)("select",{name:"recommendedTime",value:I.recommendedTime,onChange:ee,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"all",children:"ตลอดวัน"}),(0,r.jsx)("option",{value:"morning",children:"เช้า (06:00-11:59)"}),(0,r.jsx)("option",{value:"afternoon",children:"กลางวัน (12:00-17:59)"}),(0,r.jsx)("option",{value:"evening",children:"เย็น (18:00-23:59)"})]})]})]})})]})]})]})}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ตัวเลือกเพิ่มเติม"}),(0,r.jsxs)("div",{className:"space-y-2",children:[I.options.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-md",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:e.name}),(0,r.jsxs)("span",{className:"ml-2 text-gray-500",children:["+฿",e.price.toFixed(2)]})]}),(0,r.jsx)("button",{type:"button",onClick:()=>ea(e.id),className:"text-red-500 hover:text-red-700",children:(0,r.jsx)(p.A,{className:"h-4 w-4"})})]},e.id)),(0,r.jsxs)("div",{className:"flex items-end gap-2 mt-2",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:"ชื่อตัวเลือก"}),(0,r.jsx)("input",{type:"text",value:q.name,onChange:e=>z({...q,name:e.target.value}),placeholder:"เช่น เพิ่มหมู, เพิ่มวิปครีม",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,r.jsxs)("div",{className:"w-24",children:[(0,r.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:"ราคา (฿)"}),(0,r.jsx)("input",{type:"number",value:q.price,onChange:e=>z({...q,price:e.target.value}),placeholder:"0",min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,r.jsx)("button",{type:"button",onClick:()=>{if(!q.name||!q.price)return void es("กรุณากรอกชื่อและราคาของตัวเลือก","error");H({...I,options:[...I.options,{id:Date.now().toString(),name:q.name,price:Number(q.price)}]}),z({name:"",price:""})},className:"px-3 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200",children:(0,r.jsx)(O.A,{className:"h-4 w-4"})})]})]})]}),(0,r.jsxs)("div",{className:"mt-6 flex justify-end space-x-3",children:[(0,r.jsx)("button",{type:"button",className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700",onClick:()=>L(!1),children:"ยกเลิก"}),(0,r.jsx)("button",{type:"button",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center",onClick:k?K:Z,disabled:i,children:i?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(C.A,{className:"h-4 w-4 mr-2 animate-spin"}),"กำลังบันทึก..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(S.A,{className:"h-4 w-4 mr-2"}),k?"อัปเดต":"บันทึก"]})})]})]})})}),x.show&&(0,r.jsx)("div",{className:"fixed bottom-4 right-4 px-6 py-3 rounded-lg shadow-lg z-50 ".concat("success"===x.type?"bg-green-500":"bg-red-500"," text-white"),children:x.message})]})}var L=t(3717),I=t(5196),H=t(3904),q=t(1007),z=t(7712),J=t(5589);let Q=async()=>"Notification"in window&&"granted"===await Notification.requestPermission(),G=(e,s,t)=>{if("Notification"in window&&"granted"===Notification.permission){let r=new Notification(e,{body:s,icon:null!=t?t:"/favicon.ico",badge:"/favicon.ico",tag:"restaurant-order",requireInteraction:!0});r.onclick=()=>{window.focus(),r.close()},setTimeout(()=>r.close(),1e4)}};function Z(){let[e,s]=(0,a.useState)([]),[t,l]=(0,a.useState)(!1),[n,i]=(0,a.useState)("all"),[c,m]=(0,a.useState)(null),[x,u]=(0,a.useState)(""),[h,g]=(0,a.useState)({show:!1,message:"",type:""}),b=(0,D.useRouter)(),[j,f]=(0,a.useState)(null),[N,v]=(0,a.useState)([]),[w,A]=(0,a.useState)({order:null,show:!1}),[k,C]=(0,a.useState)(0),[S,_]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let e=(0,F.hg)(E.j2,e=>{e?m(e.uid):b.push("/login")});return()=>e()},[b]),(0,a.useEffect)(()=>{if(c){let e=R(c);return()=>e&&e()}},[n,c]);let R=e=>{try{let t;l(!0);let r=new Date;return r.setHours(0,0,0,0),t="all"!==n?(0,P.P)((0,P.rJ)(E.db,"users",e,"orders"),(0,P._M)("status","==",n),(0,P._M)("createdAt",">=",r),(0,P.My)("createdAt","desc")):(0,P.P)((0,P.rJ)(E.db,"users",e,"orders"),(0,P._M)("createdAt",">=",r),(0,P.My)("createdAt","desc")),(0,P.aQ)(t,e=>{let t=[];e.forEach(e=>{let s=e.data();t.push({id:e.id,...s})}),s(t),t.length>k&&k>0&&t.slice(0,t.length-k).forEach(e=>{if("pending"===e.status){var s,t;if(G("\uD83D\uDD14 ออเดอร์ใหม่!","โต๊ะ ".concat(e.table," - ").concat((null==(s=e.items)?void 0:s.length)||0," รายการ (฿").concat((null==(t=e.totalAmount)?void 0:t.toFixed(2))||"0",")")),"Audio"in window)try{let e=new Audio("/notification.mp3");e.volume=.5,e.play().catch(()=>{})}catch(e){}}}),C(t.length),l(!1)},e=>{console.error("Error in orders real-time listener:",e),V("ไม่สามารถโหลดข้อมูลออเดอร์ได้","error"),l(!1)})}catch(e){return console.error("Error setting up orders listener:",e),V("ไม่สามารถโหลดข้อมูลออเดอร์ได้","error"),l(!1),()=>{}}},M=async e=>{try{let s=(0,P.P)((0,P.rJ)(E.db,"users",e,"orders"),(0,P._M)("status","==","cooking"),(0,P.My)("queueNumber","asc")),t=await (0,P.GG)(s),r=(0,P.wP)(E.db);t.docs.forEach((e,s)=>{let t=e.ref;r.update(t,{queueNumber:s+1,updatedAt:(0,P.O5)()})}),await r.commit()}catch(e){console.error("Error updating queue numbers:",e)}},Z=async e=>{if(c&&e.receiptUrl)try{let s=new Date;s.setDate(s.getDate()+7),await (0,P.gS)((0,P.rJ)(E.db,"users",c,"receipts"),{orderId:e.id,table:e.table,amount:e.totalAmount,receiptUrl:e.receiptUrl,uploadedAt:(0,P.O5)(),expiresAt:s,paymentMethod:e.paymentMethod})}catch(e){console.error("Error saving receipt:",e)}},K=async e=>{if(e.memberId&&e.pointsEarned)try{await (0,J.z0)(c,e.memberId,e.pointsEarned,e.id,"ได้รับแต้มจากออเดอร์ #".concat(e.id.slice(-6).toUpperCase()));let s=(e.memberTotalSpent||0)+e.totalAmount;await (0,J.mn)(c,e.memberId,s),console.log("Added ".concat(e.pointsEarned," points to member ").concat(e.memberId))}catch(e){console.error("Error processing points:",e)}},B=async(s,t)=>{if(c)try{l(!0);let r=(0,P.H9)(E.db,"users",c,"orders",s),a={status:t,updatedAt:(0,P.O5)()};if("cooking"===t){let t=(0,P.P)((0,P.rJ)(E.db,"users",c,"orders"),(0,P._M)("status","==","cooking"),(0,P.My)("updatedAt","asc"));a.queueNumber=(await (0,P.GG)(t)).size+1;let r=e.find(e=>e.id===s);r&&"scan"===r.paymentMethod&&r.receiptUrl&&await Z(r)}if("completed"===t){let t=e.find(e=>e.id===s);t&&await K(t)}await (0,P.mZ)(r,a),("served"===t||"cancelled"===t)&&await M(c),V('อัปเดตสถานะออเดอร์เป็น "'.concat(t,'" สำเร็จ'),"success")}catch(e){console.error("Error updating order status:",e),V("ไม่สามารถอัปเดตสถานะออเดอร์ได้","error")}finally{l(!1)}},V=(e,s)=>{g({show:!0,message:e,type:s}),setTimeout(()=>{g({show:!1,message:"",type:""})},3e3)},X=(e,s)=>{switch(e){case"pending":return(0,r.jsx)("span",{className:"bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full text-xs",children:"รอยืนยัน"});case"cooking":return(0,r.jsxs)("span",{className:"bg-orange-100 text-orange-800 px-2 py-1 rounded-full text-xs",children:["กำลังปรุง ",s&&"(คิว #".concat(s,")")]});case"served":return(0,r.jsx)("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs",children:"เสิร์ฟแล้ว"});case"completed":return(0,r.jsx)("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs",children:"เสร็จสิ้น"});case"cancelled":return(0,r.jsx)("span",{className:"bg-red-100 text-red-800 px-2 py-1 rounded-full text-xs",children:"ยกเลิก"});default:return(0,r.jsx)("span",{className:"bg-gray-100 text-gray-800 px-2 py-1 rounded-full text-xs",children:e})}},W=e=>{f(e),v([...e.items])},Y=async()=>{if(c&&j)try{l(!0);let e=N.reduce((e,s)=>{let t=s.price*s.quantity,r=s.selectedOptions?s.selectedOptions.reduce((e,s)=>e+s.price,0)*s.quantity:0;return e+t+r},0),s=0;j.memberId&&(s=(0,J.mQ)(e),j.appliedPromotion&&"points_multiplier"===j.appliedPromotion.type&&(s*=j.appliedPromotion.value));let t=(0,P.H9)(E.db,"users",c,"orders",j.id);await (0,P.mZ)(t,{items:N,totalAmount:e,pointsEarned:s,updatedAt:(0,P.O5)()}),f(null),V("อัปเดตออเดอร์สำเร็จ","success")}catch(e){console.error("Error updating order:",e),V("ไม่สามารถอัปเดตออเดอร์ได้","error")}finally{l(!1)}},$=(e,s)=>{if(s<1)return void ee(e);v(t=>t.map((t,r)=>r===e?{...t,quantity:s}:t))},ee=e=>{v(s=>s.filter((s,t)=>t!==e))},es=(e,s)=>{v(t=>t.map((t,r)=>r===e?{...t,specialInstructions:s}:t))},et=e=>{let s=[];switch("completed"!==e.status&&"cancelled"!==e.status&&s.push((0,r.jsxs)("button",{className:"px-3 py-1 bg-gray-600 text-white text-xs rounded-md flex items-center mr-2",onClick:()=>W(e),children:[(0,r.jsx)(L.A,{className:"h-3 w-3 mr-1"})," แก้ไข"]},"edit")),e.status){case"pending":s.push((0,r.jsxs)("button",{className:"px-3 py-1 bg-green-600 text-white text-xs rounded-md flex items-center",onClick:()=>B(e.id,"cooking"),children:[(0,r.jsx)(I.A,{className:"h-3 w-3 mr-1"})," ยืนยัน"]},"confirm"),(0,r.jsxs)("button",{className:"px-3 py-1 bg-red-600 text-white text-xs rounded-md flex items-center ml-2",onClick:()=>B(e.id,"cancelled"),children:[(0,r.jsx)(p.A,{className:"h-3 w-3 mr-1"})," ปฏิเสธ"]},"reject"));break;case"cooking":s.push((0,r.jsxs)("button",{className:"px-3 py-1 bg-blue-600 text-white text-xs rounded-md flex items-center",onClick:()=>B(e.id,"served"),children:[(0,r.jsx)(o.A,{className:"h-3 w-3 mr-1"})," เสิร์ฟแล้ว"]},"served"));break;case"served":s.push((0,r.jsxs)("button",{className:"px-3 py-1 bg-green-600 text-white text-xs rounded-md flex items-center",onClick:()=>B(e.id,"completed"),children:[(0,r.jsx)(I.A,{className:"h-3 w-3 mr-1"})," เสร็จสิ้น"]},"complete"))}return(0,r.jsx)("div",{className:"flex",children:s})},er=x?e.filter(e=>{var s;return e.table.toLowerCase().includes(x.toLowerCase())||e.id.toLowerCase().includes(x.toLowerCase())||(null==(s=e.memberPhone)?void 0:s.includes(x))}):e;return(0,a.useEffect)(()=>{(async()=>{_(await Q())})()},[]),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"bg-white p-4 md:p-6 rounded-xl shadow-sm border border-gray-100",children:[(0,r.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6",children:[(0,r.jsx)("h2",{className:"text-lg md:text-xl font-bold mb-4 md:mb-0",children:"จัดการออเดอร์"}),(0,r.jsxs)("div",{className:"w-full md:w-auto flex flex-col md:flex-row space-y-3 md:space-y-0 md:space-x-3",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(T.A,{className:"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,r.jsx)("input",{type:"text",placeholder:"ค้นหาโต๊ะ, ออเดอร์, เบอร์โทร",className:"pl-9 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 w-full md:w-48",value:x,onChange:e=>u(e.target.value)})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(U.A,{className:"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,r.jsxs)("select",{className:"pl-9 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 w-full appearance-none",value:n,onChange:e=>i(e.target.value),children:[(0,r.jsx)("option",{value:"all",children:"ทั้งหมด"}),(0,r.jsx)("option",{value:"pending",children:"รอยืนยัน"}),(0,r.jsx)("option",{value:"cooking",children:"กำลังปรุง"}),(0,r.jsx)("option",{value:"served",children:"เสิร์ฟแล้ว"}),(0,r.jsx)("option",{value:"completed",children:"เสร็จสิ้น"}),(0,r.jsx)("option",{value:"cancelled",children:"ยกเลิก"})]})]}),(0,r.jsxs)("button",{className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 flex items-center justify-center",onClick:()=>{c&&R(c)},children:[(0,r.jsx)(H.A,{className:"h-4 w-4 mr-2"}),"รีเฟรช"]})]})]}),(0,r.jsx)("div",{className:"mb-4 p-3 bg-yellow-50 rounded-lg border border-yellow-200",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-medium text-yellow-800",children:"การแจ้งเตือน"}),(0,r.jsx)("p",{className:"text-sm text-yellow-700",children:S?"✅ เปิดการแจ้งเตือนแล้ว - คุณจะได้รับแจ้งเตือนเมื่อมีออเดอร์ใหม่":"❌ ยังไม่ได้เปิดการแจ้งเตือน"})]}),!S&&(0,r.jsx)("button",{onClick:async()=>{_(await Q())},className:"px-3 py-1 bg-yellow-600 text-white text-sm rounded-md hover:bg-yellow-700",children:"เปิดการแจ้งเตือน"})]})}),(0,r.jsx)("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg text-sm text-blue-800",children:(0,r.jsx)("p",{children:'หมายเหตุ: รายได้จะถูกคำนวณเฉพาะออเดอร์ที่มีสถานะ "เสร็จสิ้น" เท่านั้น ออเดอร์ที่ถูกปฏิเสธจะไม่ถูกนับเป็นรายได้'})}),t?(0,r.jsx)("div",{className:"flex justify-center items-center py-20",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500"})}):er.length>0?(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"โต๊ะ"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"รายการ"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ราคารวม"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"เวลา"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"สถานะ"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"การชำระเงิน"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"สมาชิก"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"การดำเนินการ"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:er.map(e=>{var s,t,a,l,n;return(0,r.jsxs)("tr",{className:"cancelled"===e.status?"bg-gray-50":"",children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:["โต๊ะ ",e.table||"-"]})}),(0,r.jsxs)("td",{className:"px-6 py-4",children:[(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:[(null==(s=e.items)?void 0:s.length)||0," รายการ"]}),(0,r.jsxs)("div",{className:"text-xs text-gray-400 mt-1",children:[null==(t=e.items)?void 0:t.slice(0,2).map((s,t)=>{var a;return(0,r.jsxs)("span",{children:[s.name," x",s.quantity,s.selectedOptions&&s.selectedOptions.length>0&&" (".concat(s.selectedOptions.map(e=>e.name).join(", "),")"),s.specialInstructions&&" (".concat(s.specialInstructions,")"),t<Math.min(1,((null==(a=e.items)?void 0:a.length)||0)-1)?", ":""]},t)}),((null==(a=e.items)?void 0:a.length)||0)>2&&" และอื่นๆ อีก ".concat(e.items.length-2," รายการ")]})]}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,r.jsxs)("div",{className:"text-sm ".concat("cancelled"===e.status?"text-gray-500 line-through":"text-gray-900"),children:["฿",(null==(l=e.totalAmount)?void 0:l.toFixed(2))||"0"]}),e.originalAmount&&e.originalAmount!==e.totalAmount&&(0,r.jsxs)("div",{className:"text-xs text-gray-500 line-through",children:["฿",e.originalAmount.toFixed(2)]}),e.appliedPromotion&&(0,r.jsx)("div",{className:"text-xs text-purple-600",children:e.appliedPromotion.title}),"cancelled"===e.status&&(0,r.jsx)("div",{className:"text-xs text-red-500 mt-1",children:"ไม่นับเป็นรายได้"})]}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-gray-500",children:(null==(n=e.createdAt)?void 0:n.toDate)?new Date(e.createdAt.toDate()).toLocaleTimeString("th-TH",{hour:"2-digit",minute:"2-digit"}):"-"})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:X(e.status,e.queueNumber)}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-gray-900",children:"scan"===e.paymentMethod?(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs mr-2",children:"สแกนจ่าย"}),e.receiptUrl&&(0,r.jsx)("button",{onClick:()=>A({order:e,show:!0}),className:"text-blue-600 hover:text-blue-800 text-xs underline",children:"ดูใบเสร็จ"}),!e.receiptUrl&&(0,r.jsx)("span",{className:"text-gray-500 text-xs",children:"ไม่มีใบเสร็จ"})]}):"counter"===e.paymentMethod?(0,r.jsx)("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs",children:"จ่ายเคาเตอร์"}):(0,r.jsx)("span",{className:"bg-gray-100 text-gray-800 px-2 py-1 rounded-full text-xs",children:"ไม่ระบุ"})})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:e.memberId?(0,r.jsxs)("div",{className:"text-sm",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(q.A,{className:"h-4 w-4 text-green-600 mr-1"}),(0,r.jsx)("span",{className:"font-medium text-green-600",children:"สมาชิก"})]}),(0,r.jsx)("div",{className:"text-xs text-gray-500",children:e.memberPhone||"ไม่ระบุ"}),e.pointsEarned&&"completed"===e.status&&(0,r.jsxs)("div",{className:"text-xs text-blue-600 flex items-center",children:[(0,r.jsx)(y.A,{className:"h-3 w-3 mr-1"}),"+",e.pointsEarned," แต้ม"]}),e.pointsEarned&&"completed"!==e.status&&(0,r.jsxs)("div",{className:"text-xs text-gray-500 flex items-center",children:[(0,r.jsx)(y.A,{className:"h-3 w-3 mr-1"}),"จะได้ ",e.pointsEarned," แต้ม"]})]}):(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"ไม่เป็นสมาชิก"})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:et(e)})]},e.id)})})]})}):(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 px-4 text-center",children:[(0,r.jsx)("div",{className:"bg-gray-100 p-4 rounded-full mb-4",children:(0,r.jsx)(d.A,{className:"h-8 w-8 text-gray-400"})}),(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"ยังไม่มีออเดอร์"}),(0,r.jsx)("p",{className:"text-sm text-gray-500 max-w-md mb-6",children:"ออเดอร์ใหม่จะปรากฏที่นี่เมื่อลูกค้าสั่งอาหาร"})]})]}),j&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"p-4 border-b border-gray-200 flex items-center",children:[(0,r.jsxs)("h2",{className:"text-lg font-bold",children:["แก้ไขออเดอร์ #",j.id.slice(-6).toUpperCase()]}),(0,r.jsx)("button",{onClick:()=>f(null),className:"ml-auto p-1 rounded-full hover:bg-gray-100",children:(0,r.jsx)(p.A,{className:"h-5 w-5 text-gray-500"})})]}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,r.jsx)("h3",{className:"font-medium",children:"รายการอาหาร"}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:["โต๊ะ ",j.table,j.memberId&&(0,r.jsx)("span",{className:"ml-2 text-green-600",children:"• สมาชิก"})]})]}),(0,r.jsx)("div",{className:"space-y-3",children:N.map((e,s)=>(0,r.jsxs)("div",{className:"border border-gray-200 rounded-md p-3",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"font-medium",children:[e.name,e.selectedOptions&&e.selectedOptions.length>0&&(0,r.jsxs)("span",{className:"font-normal text-sm text-gray-600 ml-1",children:["(",e.selectedOptions.map(e=>e.name).join(", "),")"]})]}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:["฿",e.price.toFixed(2),e.selectedOptions&&e.selectedOptions.length>0&&(0,r.jsxs)("span",{className:"ml-2",children:["+ ฿",e.selectedOptions.reduce((e,s)=>e+s.price,0).toFixed(2)]})]}),e.specialInstructions&&(0,r.jsxs)("div",{className:"text-sm italic text-gray-600 mt-1",children:['"',e.specialInstructions,'"']})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("button",{onClick:()=>$(s,e.quantity-1),className:"p-1 rounded-full bg-gray-100",children:(0,r.jsx)(z.A,{className:"h-4 w-4 text-gray-600"})}),(0,r.jsx)("span",{className:"mx-2 w-6 text-center",children:e.quantity}),(0,r.jsx)("button",{onClick:()=>$(s,e.quantity+1),className:"p-1 rounded-full bg-gray-100",children:(0,r.jsx)(O.A,{className:"h-4 w-4 text-gray-600"})}),(0,r.jsx)("button",{onClick:()=>ee(s),className:"ml-2 p-1 rounded-full bg-red-100 text-red-600",children:(0,r.jsx)(p.A,{className:"h-4 w-4"})})]})]}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)("textarea",{placeholder:"คำแนะนำพิเศษ เช่น ไม่ใส่ผัก",className:"w-full p-2 text-sm border border-gray-200 rounded-md",rows:2,value:e.specialInstructions||"",onChange:e=>es(s,e.target.value)})})]},s))}),0===N.length&&(0,r.jsx)("div",{className:"text-center py-4 text-gray-500",children:"ไม่มีรายการอาหาร กรุณาเพิ่มรายการอาหาร"})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center font-medium mb-4",children:[(0,r.jsx)("div",{children:"ยอดรวม"}),(0,r.jsxs)("div",{children:["฿",N.reduce((e,s)=>e+s.price*s.quantity+(s.selectedOptions?s.selectedOptions.reduce((e,s)=>e+s.price,0)*s.quantity:0),0).toFixed(2)]})]}),j.memberId&&(0,r.jsx)("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg border border-blue-200",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(y.A,{className:"h-4 w-4 text-blue-600 mr-2"}),(0,r.jsx)("span",{className:"text-sm font-medium text-blue-800",children:"แต้มที่จะได้รับ"})]}),(0,r.jsxs)("div",{className:"text-sm font-bold text-blue-800",children:[(0,J.mQ)(N.reduce((e,s)=>e+s.price*s.quantity+(s.selectedOptions?s.selectedOptions.reduce((e,s)=>e+s.price,0)*s.quantity:0),0))," แต้ม"]})]})}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,r.jsx)("button",{onClick:()=>f(null),className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700",children:"ยกเลิก"}),(0,r.jsx)("button",{onClick:Y,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",disabled:t||0===N.length,children:t?(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2"}),"กำลังบันทึก..."]}):"บันทึกการเปลี่ยนแปลง"})]})]})]})}),w.show&&w.order&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"p-4 border-b border-gray-200 flex items-center justify-between",children:[(0,r.jsx)("h3",{className:"text-lg font-bold",children:"หลักฐานการโอนเงิน"}),(0,r.jsx)("button",{onClick:()=>A({order:null,show:!1}),className:"text-gray-500 hover:text-gray-700",children:(0,r.jsx)(p.A,{className:"h-5 w-5"})})]}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"ออเดอร์:"})," #",w.order.id.slice(-6).toUpperCase()]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"โต๊ะ:"})," ",w.order.table]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"จำนวนเงิน:"})," ฿",w.order.totalAmount.toFixed(2)]}),w.order.memberId&&(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"สมาชิก:"})," ",w.order.memberPhone]})]}),(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)("img",{src:w.order.receiptUrl||"/placeholder.svg",alt:"Receipt",className:"max-w-full h-auto border border-gray-200 rounded-lg"})})]})]})}),h.show&&(0,r.jsx)("div",{className:"fixed bottom-4 right-4 px-6 py-3 rounded-lg shadow-lg z-50 ".concat("success"===h.type?"bg-green-500":"bg-red-500"," text-white"),children:h.message})]})}var K=t(2583),B=t(1788),V=t(1304);function X(){let[e,s]=(0,a.useState)([]),[t,n]=(0,a.useState)([]),[i,c]=(0,a.useState)(!1),[o,m]=(0,a.useState)(null),[u,h]=(0,a.useState)(""),[p,g]=(0,a.useState)("today"),[j,y]=(0,a.useState)({show:!1,message:"",type:""}),[f,N]=(0,a.useState)(null),v=(0,D.useRouter)();(0,a.useEffect)(()=>{let e=(0,F.hg)(E.j2,e=>{e?(m(e.uid),w(e.uid)):v.push("/login")});return()=>e()},[v]),(0,a.useEffect)(()=>{if(o){let e=A(o);return()=>e&&e()}},[o,p]);let w=async e=>{try{let s=await (0,P.GG)((0,P.P)((0,P.rJ)(E.db,"users"),(0,P._M)("__name__","==",e)));s.empty||N(s.docs[0].data())}catch(e){console.error("Error fetching restaurant info:",e)}},A=e=>{try{c(!0);let t=new Date,r=new Date;switch(p){case"today":t.setHours(0,0,0,0),r.setHours(23,59,59,999);break;case"week":t.setDate(t.getDate()-7),t.setHours(0,0,0,0),r.setHours(23,59,59,999);break;case"month":t.setDate(1),t.setHours(0,0,0,0),(r=new Date(t.getFullYear(),t.getMonth()+1,0)).setHours(23,59,59,999);break;case"all":t=new Date(2020,0,1),r.setHours(23,59,59,999)}let a=(0,P.P)((0,P.rJ)(E.db,"users",e,"orders"),(0,P._M)("status","==","completed"),(0,P._M)("createdAt",">=",t),(0,P._M)("createdAt","<=",r),(0,P.My)("createdAt","desc"));return(0,P.aQ)(a,e=>{let t=[];e.forEach(e=>{let s=e.data();t.push({id:e.id,...s})}),s(t),c(!1)},e=>{console.error("Error in orders real-time listener:",e),O("ไม่สามารถโหลดข้อมูลบิลได้","error"),c(!1)})}catch(e){return console.error("Error setting up orders listener:",e),O("ไม่สามารถโหลดข้อมูลบิลได้","error"),c(!1),()=>{}}};(0,a.useEffect)(()=>{u?n(e.filter(e=>e.table.toLowerCase().includes(u.toLowerCase())||e.id.toLowerCase().includes(u.toLowerCase()))):n(e)},[e,u]);let k=e=>{var s,t,r;let a=(null==(s=e.createdAt)?void 0:s.toDate)?e.createdAt.toDate():new Date,l=(null==f?void 0:f.storeName)||(null==f?void 0:f.restaurantName)||"ร้านอาหาร",n=(null==f?void 0:f.phone)||(null==f?void 0:f.phoneNumber)||"",i="\n=================================\n".concat(l,"\n=================================\n").concat(n?"โทร: ".concat(n):"","\nวันที่: ").concat(a.toLocaleDateString("th-TH"),"\nเวลา: ").concat(a.toLocaleTimeString("th-TH"),"\nโต๊ะ: ").concat(e.table,"\nบิลเลขที่: #").concat(e.id.slice(-6).toUpperCase(),"\n=================================\n\nรายการอาหาร:\n"),c=0;return null==(t=e.items)||t.forEach((e,s)=>{var t;let r=(e.price+((null==(t=e.selectedOptions)?void 0:t.reduce((e,s)=>e+s.price,0))||0))*e.quantity;c+=e.quantity,i+="".concat(s+1,". ").concat(e.name," x").concat(e.quantity,"\n"),i+="   ราคา: ฿".concat(e.price.toFixed(2)),e.selectedOptions&&e.selectedOptions.length>0&&(i+="\n   ตัวเลือก: ".concat(e.selectedOptions.map(e=>"".concat(e.name," (+฿").concat(e.price,")")).join(", "))),e.specialInstructions&&(i+="\n   หมายเหตุ: ".concat(e.specialInstructions)),i+="\n   รวม: ฿".concat(r.toFixed(2),"\n\n")}),i+="=================================\nจำนวนรายการทั้งหมด: ".concat(c," ชิ้น\nยอดรวมทั้งสิ้น: ฿").concat((null==(r=e.totalAmount)?void 0:r.toFixed(2))||"0.00","\n=================================\n\nขอบคุณที่ใช้บริการ\nกรุณาเก็บใบเสร็จไว้เป็นหลักฐาน\n")},C=e=>{let s=new Blob([k(e)],{type:"text/plain;charset=utf-8"}),t=URL.createObjectURL(s),r=document.createElement("a");r.href=t,r.download="bill-".concat(e.id.slice(-6),"-table").concat(e.table,".txt"),document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(t),O("ดาวน์โหลดบิลสำเร็จ","success")},S=e=>{let s=k(e),t=window.open("","_blank");t&&(t.document.write("\n        <html>\n          <head>\n            <title>บิล #".concat(e.id.slice(-6).toUpperCase(),"</title>\n            <style>\n              body { font-family: 'Courier New', monospace; white-space: pre-line; margin: 20px; }\n              @media print { body { margin: 0; } }\n            </style>\n          </head>\n          <body>").concat(s,"</body>\n        </html>\n      ")),t.document.close(),t.print())},O=(e,s)=>{y({show:!0,message:e,type:s}),setTimeout(()=>{y({show:!1,message:"",type:""})},3e3)},U=t.reduce((e,s)=>e+(s.totalAmount||0),0),_=t.length;return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"bg-white p-4 md:p-6 rounded-xl shadow-sm border border-gray-100",children:[(0,r.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6",children:[(0,r.jsx)("h2",{className:"text-lg md:text-xl font-bold mb-4 md:mb-0",children:"จัดการบิล"}),(0,r.jsxs)("div",{className:"w-full md:w-auto flex flex-col md:flex-row space-y-3 md:space-y-0 md:space-x-3",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(T.A,{className:"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,r.jsx)("input",{type:"text",placeholder:"ค้นหาโต๊ะหรือเลขบิล",className:"pl-9 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 w-full md:w-48",value:u,onChange:e=>h(e.target.value)})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(x.A,{className:"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,r.jsxs)("select",{className:"pl-9 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 w-full appearance-none",value:p,onChange:e=>g(e.target.value),children:[(0,r.jsx)("option",{value:"today",children:"วันนี้"}),(0,r.jsx)("option",{value:"week",children:"7 วันที่ผ่านมา"}),(0,r.jsx)("option",{value:"month",children:"เดือนนี้"}),(0,r.jsx)("option",{value:"all",children:"ทั้งหมด"})]})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[(0,r.jsx)("div",{className:"bg-green-50 p-4 rounded-lg",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(l.A,{className:"h-8 w-8 text-green-600 mr-3"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-green-700",children:"รายได้รวม"}),(0,r.jsxs)("h3",{className:"text-xl font-bold text-green-900",children:["฿",U.toFixed(2)]})]})]})}),(0,r.jsx)("div",{className:"bg-blue-50 p-4 rounded-lg",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(b.A,{className:"h-8 w-8 text-blue-600 mr-3"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-blue-700",children:"จำนวนบิล"}),(0,r.jsx)("h3",{className:"text-xl font-bold text-blue-900",children:_})]})]})}),(0,r.jsx)("div",{className:"bg-purple-50 p-4 rounded-lg",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(d.A,{className:"h-8 w-8 text-purple-600 mr-3"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-purple-700",children:"มูลค่าเฉลี่ย"}),(0,r.jsxs)("h3",{className:"text-xl font-bold text-purple-900",children:["฿",_>0?(U/_).toFixed(2):"0.00"]})]})]})})]}),i?(0,r.jsx)("div",{className:"flex justify-center items-center py-20",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500"})}):t.length>0?(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"เลขบิล"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"โต๊ะ"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"วันที่/เวลา"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"รายการ"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ยอดรวม"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"การดำเนินการ"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(e=>{var s,t,a,l,n,i;return(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:["#",e.id.slice(-6).toUpperCase()]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"text-sm text-gray-900",children:["โต๊ะ ",e.table]})}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,r.jsx)("div",{className:"text-sm text-gray-900",children:(null==(s=e.createdAt)?void 0:s.toDate)?new Date(e.createdAt.toDate()).toLocaleDateString("th-TH",{day:"2-digit",month:"2-digit",year:"numeric"}):"-"}),(0,r.jsx)("div",{className:"text-xs text-gray-500",children:(null==(t=e.createdAt)?void 0:t.toDate)?new Date(e.createdAt.toDate()).toLocaleTimeString("th-TH",{hour:"2-digit",minute:"2-digit"}):"-"})]}),(0,r.jsxs)("td",{className:"px-6 py-4",children:[(0,r.jsxs)("div",{className:"text-sm text-gray-900",children:[(null==(a=e.items)?void 0:a.length)||0," รายการ"]}),(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:[null==(l=e.items)?void 0:l.slice(0,2).map((s,t)=>{var a;return(0,r.jsxs)("span",{children:[s.name," x",s.quantity,t<Math.min(1,((null==(a=e.items)?void 0:a.length)||0)-1)?", ":""]},t)}),((null==(n=e.items)?void 0:n.length)||0)>2&&" และอื่นๆ อีก ".concat(e.items.length-2," รายการ")]})]}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"text-sm font-medium text-green-600",children:["฿",(null==(i=e.totalAmount)?void 0:i.toFixed(2))||"0"]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsxs)("button",{onClick:()=>C(e),className:"px-3 py-1 bg-blue-600 text-white text-xs rounded-md hover:bg-blue-700 flex items-center",children:[(0,r.jsx)(B.A,{className:"h-3 w-3 mr-1"}),"ดาวน์โหลด"]}),(0,r.jsxs)("button",{onClick:()=>S(e),className:"px-3 py-1 bg-gray-600 text-white text-xs rounded-md hover:bg-gray-700 flex items-center",children:[(0,r.jsx)(V.A,{className:"h-3 w-3 mr-1"}),"พิมพ์"]})]})})]},e.id)})})]})}):(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 px-4 text-center",children:[(0,r.jsx)("div",{className:"bg-gray-100 p-4 rounded-full mb-4",children:(0,r.jsx)(b.A,{className:"h-8 w-8 text-gray-400"})}),(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"ไม่มีบิลในช่วงเวลานี้"}),(0,r.jsx)("p",{className:"text-sm text-gray-500 max-w-md mb-6",children:"บิลจะปรากฏที่นี่เมื่อมีออเดอร์ที่เสร็จสิ้นแล้ว"})]})]}),j.show&&(0,r.jsx)("div",{className:"fixed bottom-4 right-4 px-6 py-3 rounded-lg shadow-lg z-50 ".concat("success"===j.type?"bg-green-500":"bg-red-500"," text-white"),children:j.message})]})}var W=t(5339);function Y(){let[e,s]=(0,a.useState)(null),[t,l]=(0,a.useState)(""),[n,i]=(0,a.useState)(!1),[c,d]=(0,a.useState)({show:!1,message:"",type:""});(0,a.useEffect)(()=>{let e=(0,F.hg)(E.j2,e=>{e&&(s(e),o(e.uid))});return()=>e()},[]);let o=e=>{let s=(0,P.H9)(E.db,"users",e);return(0,P.aQ)(s,e=>{e.exists()&&l(e.data().promptPayID||"")})},m=async()=>{if(e)try{i(!0);let s=(0,P.H9)(E.db,"users",e.uid);await (0,P.mZ)(s,{promptPayID:t,updatedAt:new Date}),x("บันทึก PromptPay ID สำเร็จ","success")}catch(e){console.error("Error saving PromptPay ID:",e),x("ไม่สามารถบันทึก PromptPay ID ได้","error")}finally{i(!1)}},x=(e,s)=>{d({show:!0,message:e,type:s}),setTimeout(()=>{d({show:!1,message:"",type:""})},3e3)};return(0,r.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[(0,r.jsxs)("div",{className:"flex items-center mb-6",children:[(0,r.jsx)(g.A,{className:"h-6 w-6 text-blue-600 mr-2"}),(0,r.jsx)("h2",{className:"text-xl font-bold",children:"ตั้งค่า PromptPay สำหรับรับเงิน"})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(g.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,r.jsx)("h3",{className:"text-lg font-medium mb-2",children:"PromptPay ID สำหรับรับเงิน"}),(0,r.jsx)("p",{className:"text-gray-500 mb-4",children:"กรอกหมายเลข PromptPay (เบอร์โทรศัพท์หรือเลขประจำตัวประชาชน) สำหรับรับเงินจากลูกค้า"}),(0,r.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,r.jsx)("input",{type:"text",value:t,onChange:e=>l(e.target.value),placeholder:"เบอร์โทรศัพท์หรือเลขประจำตัวประชาชน",className:"w-full max-w-md px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none"}),(0,r.jsx)("button",{onClick:m,disabled:n||!t,className:"px-6 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 flex items-center",children:n?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2"}),"กำลังบันทึก..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(I.A,{className:"h-4 w-4 mr-2"}),"บันทึก PromptPay ID"]})})]})]})}),(0,r.jsx)("div",{className:"bg-blue-50 p-4 rounded-lg",children:(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)(W.A,{className:"h-5 w-5 text-blue-600 mr-2 mt-0.5"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium text-blue-900 mb-2",children:"คำแนะนำ:"}),(0,r.jsxs)("ul",{className:"text-sm text-blue-800 space-y-1",children:[(0,r.jsx)("li",{children:"• ใช้หมายเลข PromptPay ที่ลงทะเบียนกับธนาคารของคุณ"}),(0,r.jsx)("li",{children:"• ระบบจะสร้าง QR Code แบบไดนามิกตามยอดเงินที่ลูกค้าต้องชำระ"}),(0,r.jsx)("li",{children:"• ลูกค้าสามารถสแกน QR Code เพื่อโอนเงินได้ทันที"}),(0,r.jsx)("li",{children:"• ตรวจสอบให้แน่ใจว่าหมายเลข PromptPay ถูกต้อง"})]})]})]})})]}),c.show&&(0,r.jsx)("div",{className:"fixed bottom-4 right-4 px-6 py-3 rounded-lg shadow-lg z-50 ".concat("success"===c.type?"bg-green-500":"bg-red-500"," text-white"),children:c.message})]})}var $=t(1243),ee=t(2657),es=t(2525);function et(){var e,s;let[t,l]=(0,a.useState)([]),[n,i]=(0,a.useState)(!0),[c,d]=(0,a.useState)(null),[o,m]=(0,a.useState)({show:!1,message:"",type:""}),[x,u]=(0,a.useState)(null),[h,g]=(0,a.useState)("all");(0,a.useEffect)(()=>{let e=(0,F.hg)(E.j2,e=>{e&&(d(e),j(e.uid))});return()=>e()},[]);let j=e=>{let s=(0,P.rJ)(E.db,"users",e,"receipts"),t=(0,P.P)(s,(0,P.My)("uploadedAt","desc"));return(0,P.aQ)(t,e=>{let s=[];e.forEach(e=>{let t=e.data();s.push({id:e.id,...t})}),l(s),i(!1)})},y=async e=>{if(c)try{let s=(0,R.KR)(E.IG,e.receiptUrl);await (0,R.XR)(s),await (0,P.kd)((0,P.H9)(E.db,"users",c.uid,"receipts",e.id)),N("ลบใบเสร็จสำเร็จ","success")}catch(e){console.error("Error deleting receipt:",e),N("ไม่สามารถลบใบเสร็จได้","error")}},f=async e=>{try{if(e.receiptUrl.includes("firebasestorage.googleapis.com")){let s=document.createElement("a");s.href=e.receiptUrl,s.download="receipt-".concat(e.orderId,"-").concat(e.table,".jpg"),s.target="_blank",s.rel="noopener noreferrer",document.body.appendChild(s),s.click(),document.body.removeChild(s),N("เริ่มดาวน์โหลดใบเสร็จแล้ว","success");return}let s=await fetch(e.receiptUrl,{mode:"cors",credentials:"omit",headers:{Accept:"image/*"}});if(!s.ok)throw Error("HTTP error! status: ".concat(s.status));let t=await s.blob(),r=window.URL.createObjectURL(t),a=document.createElement("a");a.href=r,a.download="receipt-".concat(e.orderId,"-").concat(e.table,".jpg"),document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(r),N("ดาวน์โหลดใบเสร็จสำเร็จ","success")}catch(s){console.error("Error downloading receipt:",s);try{let s=document.createElement("a");s.href=e.receiptUrl,s.target="_blank",s.rel="noopener noreferrer",document.body.appendChild(s),s.click(),document.body.removeChild(s),N("เปิดใบเสร็จในแท็บใหม่แล้ว กรุณาดาวน์โหลดด้วยตนเอง","success")}catch(e){console.error("Fallback download also failed:",e),N("ไม่สามารถดาวน์โหลดใบเสร็จได้ ลองใช้เบราว์เซอร์อื่น","error")}}},N=(e,s)=>{m({show:!0,message:e,type:s}),setTimeout(()=>{m({show:!1,message:"",type:""})},3e3)},v=e=>{if(!(null==e?void 0:e.toDate))return 0;let s=new Date;return Math.ceil((e.toDate().getTime()-s.getTime())/864e5)},w=e=>{let s=v(e.expiresAt);return s<0?{text:"หมดอายุแล้ว",color:"text-red-600",bgColor:"bg-red-100"}:s<=2?{text:"หมดอายุใน ".concat(s," วัน"),color:"text-orange-600",bgColor:"bg-orange-100"}:{text:"หมดอายุใน ".concat(s," วัน"),color:"text-green-600",bgColor:"bg-green-100"}},A=(()=>{let e=new Date;switch(h){case"expiring":return t.filter(s=>{var t;let r=null==(t=s.expiresAt)?void 0:t.toDate(),a=r?Math.ceil((r.getTime()-e.getTime())/864e5):0;return a<=2&&a>0});case"expired":return t.filter(s=>{var t;let r=null==(t=s.expiresAt)?void 0:t.toDate();return r&&r<e});default:return t}})();return n?(0,r.jsx)("div",{className:"flex justify-center items-center py-20",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500"})}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(b.A,{className:"h-6 w-6 text-blue-600 mr-2"}),(0,r.jsx)("h2",{className:"text-xl font-bold",children:"จัดการใบเสร็จลูกค้า"})]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsxs)("button",{onClick:()=>g("all"),className:"px-3 py-1 rounded-md text-sm ".concat("all"===h?"bg-blue-600 text-white":"bg-gray-200 text-gray-700"),children:["ทั้งหมด (",t.length,")"]}),(0,r.jsx)("button",{onClick:()=>g("expiring"),className:"px-3 py-1 rounded-md text-sm ".concat("expiring"===h?"bg-orange-600 text-white":"bg-gray-200 text-gray-700"),children:"ใกล้หมดอายุ"}),(0,r.jsx)("button",{onClick:()=>g("expired"),className:"px-3 py-1 rounded-md text-sm ".concat("expired"===h?"bg-red-600 text-white":"bg-gray-200 text-gray-700"),children:"หมดอายุแล้ว"})]})]}),(0,r.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)($.A,{className:"h-5 w-5 text-yellow-600 mr-2 mt-0.5"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium text-yellow-800 mb-1",children:"ข้อมูลสำคัญ"}),(0,r.jsx)("p",{className:"text-sm text-yellow-700",children:"ใบเสร็จจะถูกลบออกจากระบบอัตโนมัติหลังจากอัพโหลด 7 วัน กรุณาดาวน์โหลดเก็บไว้หากต้องการใช้เป็นหลักฐาน"})]})]})}),0===A.length?(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)(b.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"all"===h?"ยังไม่มีใบเสร็จ":"expiring"===h?"ไม่มีใบเสร็จที่ใกล้หมดอายุ":"ไม่มีใบเสร็จที่หมดอายุ"}),(0,r.jsx)("p",{className:"text-gray-500",children:"all"===h?"ใบเสร็จจากลูกค้าจะแสดงที่นี่":""})]}):(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:A.map(e=>{var s,t;let a=w(e);return(0,r.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h4",{className:"font-medium",children:["ออเดอร์ #",e.orderId.slice(-6).toUpperCase()]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["โต๊ะ ",e.table]})]}),(0,r.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat(a.bgColor," ").concat(a.color),children:a.text})]}),(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsxs)("p",{className:"text-lg font-bold text-blue-600",children:["฿",e.amount.toFixed(2)]}),(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:["อัพโหลดเมื่อ: ",null==(t=e.uploadedAt)||null==(s=t.toDate())?void 0:s.toLocaleDateString("th-TH")]})]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsxs)("button",{onClick:()=>u(e),className:"flex-1 px-3 py-2 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700 flex items-center justify-center",children:[(0,r.jsx)(ee.A,{className:"h-4 w-4 mr-1"}),"ดู"]}),(0,r.jsxs)("button",{onClick:()=>f(e),className:"flex-1 px-3 py-2 bg-green-600 text-white text-sm rounded-md hover:bg-green-700 flex items-center justify-center",children:[(0,r.jsx)(B.A,{className:"h-4 w-4 mr-1"}),"ดาวน์โหลด"]}),(0,r.jsx)("button",{onClick:()=>y(e),className:"px-3 py-2 bg-red-600 text-white text-sm rounded-md hover:bg-red-700",children:(0,r.jsx)(es.A,{className:"h-4 w-4"})})]})]},e.id)})})]}),x&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"p-4 border-b border-gray-200 flex items-center justify-between",children:[(0,r.jsxs)("h3",{className:"text-lg font-bold",children:["ใบเสร็จ - ออเดอร์ #",x.orderId.slice(-6).toUpperCase()]}),(0,r.jsx)("button",{onClick:()=>u(null),className:"text-gray-500 hover:text-gray-700",children:(0,r.jsx)(p.A,{className:"h-5 w-5"})})]}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"โต๊ะ:"})," ",x.table]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"จำนวนเงิน:"})," ฿",x.amount.toFixed(2)]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"อัพโหลดเมื่อ:"})," ",null==(s=x.uploadedAt)||null==(e=s.toDate())?void 0:e.toLocaleString("th-TH")]})]}),(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)("img",{src:x.receiptUrl||"/placeholder.svg",alt:"Receipt",className:"max-w-full h-auto border border-gray-200 rounded-lg"})}),(0,r.jsxs)("div",{className:"mt-4 flex space-x-3",children:[(0,r.jsxs)("button",{onClick:()=>f(x),className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 flex items-center justify-center",children:[(0,r.jsx)(B.A,{className:"h-4 w-4 mr-2"}),"ดาวน์โหลด"]}),(0,r.jsxs)("button",{onClick:()=>{y(x),u(null)},className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 flex items-center justify-center",children:[(0,r.jsx)(es.A,{className:"h-4 w-4 mr-2"}),"ลบ"]})]})]})]})}),o.show&&(0,r.jsx)("div",{className:"fixed bottom-4 right-4 px-6 py-3 rounded-lg shadow-lg z-50 ".concat("success"===o.type?"bg-green-500":"bg-red-500"," text-white"),children:o.message})]})}function er(){let[e,s]=(0,a.useState)([]),[t,l]=(0,a.useState)([]),[n,i]=(0,a.useState)([]),[c,d]=(0,a.useState)(!0),[u,h]=(0,a.useState)(null),[p,g]=(0,a.useState)(""),[b,f]=(0,a.useState)("all");(0,a.useEffect)(()=>{let e=(0,F.hg)(E.j2,e=>{e&&(h(e),N(e.uid),v(e.uid))});return()=>e()},[]),(0,a.useEffect)(()=>{let s=e;p&&(s=s.filter(e=>e.name.toLowerCase().includes(p.toLowerCase())||e.phone.includes(p)||e.email.toLowerCase().includes(p.toLowerCase()))),"all"!==b&&(s=s.filter(e=>e.tier===b)),l(s)},[e,p,b]);let N=e=>{let t=(0,P.rJ)(E.db,"restaurants",e,"members"),r=(0,P.P)(t,(0,P.My)("joinDate","desc"));return(0,P.aQ)(r,e=>{let t=[];e.forEach(e=>{t.push({id:e.id,...e.data()})}),s(t),d(!1)})},v=e=>{let s=(0,P.rJ)(E.db,"restaurants",e,"point_transactions"),t=(0,P.P)(s,(0,P.My)("createdAt","desc"));return(0,P.aQ)(t,e=>{let s=[];e.forEach(e=>{s.push({id:e.id,...e.data()})}),i(s)})},w=e=>{switch(e){case"bronze":return"bg-orange-100 text-orange-800";case"silver":default:return"bg-gray-100 text-gray-800";case"gold":return"bg-yellow-100 text-yellow-800";case"platinum":return"bg-purple-100 text-purple-800"}},C=e=>{switch(e){case"bronze":return"\uD83E\uDD49";case"silver":return"\uD83E\uDD48";case"gold":return"\uD83E\uDD47";case"platinum":return"\uD83D\uDC8E";default:return"\uD83C\uDFC5"}},S=e.length,D=e.reduce((e,s)=>e+s.points,0),O=e.reduce((e,s)=>e+s.totalSpent,0),U=S>0?O/S:0;return c?(0,r.jsx)("div",{className:"flex justify-center items-center py-20",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500"})}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[(0,r.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(j.A,{className:"h-6 w-6 text-blue-600 mr-2"}),(0,r.jsx)("h2",{className:"text-xl font-bold",children:"จัดการสมาชิก"})]})}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[(0,r.jsx)("div",{className:"bg-blue-50 p-4 rounded-lg",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(j.A,{className:"h-8 w-8 text-blue-600 mr-3"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-blue-700",children:"สมาชิกทั้งหมด"}),(0,r.jsx)("h3",{className:"text-xl font-bold text-blue-900",children:S})]})]})}),(0,r.jsx)("div",{className:"bg-green-50 p-4 rounded-lg",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(y.A,{className:"h-8 w-8 text-green-600 mr-3"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-green-700",children:"แต้มรวมทั้งหมด"}),(0,r.jsx)("h3",{className:"text-xl font-bold text-green-900",children:D.toLocaleString()})]})]})}),(0,r.jsx)("div",{className:"bg-purple-50 p-4 rounded-lg",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(o.A,{className:"h-8 w-8 text-purple-600 mr-3"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-purple-700",children:"ยอดซื้อรวม"}),(0,r.jsxs)("h3",{className:"text-xl font-bold text-purple-900",children:["฿",O.toLocaleString()]})]})]})}),(0,r.jsx)("div",{className:"bg-orange-50 p-4 rounded-lg",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(m.A,{className:"h-8 w-8 text-orange-600 mr-3"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-orange-700",children:"ยอดซื้อเฉลี่ย"}),(0,r.jsxs)("h3",{className:"text-xl font-bold text-orange-900",children:["฿",U.toFixed(0)]})]})]})})]}),(0,r.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,r.jsxs)("div",{className:"relative flex-1",children:[(0,r.jsx)(T.A,{className:"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,r.jsx)("input",{type:"text",placeholder:"ค้นหาสมาชิก...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:p,onChange:e=>g(e.target.value)})]}),(0,r.jsxs)("select",{className:"px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:b,onChange:e=>f(e.target.value),children:[(0,r.jsx)("option",{value:"all",children:"ทุกระดับ"}),(0,r.jsx)("option",{value:"bronze",children:"Bronze"}),(0,r.jsx)("option",{value:"silver",children:"Silver"}),(0,r.jsx)("option",{value:"gold",children:"Gold"}),(0,r.jsx)("option",{value:"platinum",children:"Platinum"})]})]})]}),(0,r.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:0===t.length?(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)(j.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"ไม่พบสมาชิก"}),(0,r.jsx)("p",{className:"text-gray-500",children:"ยังไม่มีสมาชิกในระบบ"})]}):(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"สมาชิก"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ติดต่อ"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ระดับ"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"แต้มสะสม"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ยอดซื้อรวม"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"เข้าร่วมเมื่อ"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(e=>{var s;return(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center mr-3",children:(0,r.jsx)("span",{className:"text-blue-600 font-bold text-sm",children:e.name.charAt(0).toUpperCase()})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:["ID: ",e.id.slice(-6)]})]})]})}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,r.jsxs)("div",{className:"text-sm text-gray-900 flex items-center",children:[(0,r.jsx)(A.A,{className:"h-4 w-4 mr-1"}),e.phone]}),e.email&&(0,r.jsxs)("div",{className:"text-sm text-gray-500 flex items-center mt-1",children:[(0,r.jsx)(k.A,{className:"h-4 w-4 mr-1"}),e.email]})]}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(w(e.tier)),children:[(0,r.jsx)("span",{className:"mr-1",children:C(e.tier)}),e.tier.toUpperCase()]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.points.toLocaleString()})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:["฿",e.totalSpent.toLocaleString()]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"text-sm text-gray-900 flex items-center",children:[(0,r.jsx)(x.A,{className:"h-4 w-4 mr-1"}),(null==(s=e.joinDate)?void 0:s.toDate)?new Date(e.joinDate.toDate()).toLocaleDateString("th-TH"):"ไม่ระบุ"]})})]},e.id)})})]})})})]})}var ea=t(4017),el=t(6785);function en(){let[e,s]=(0,a.useState)([]),[t,l]=(0,a.useState)(!0),[n,i]=(0,a.useState)(null),[d,o]=(0,a.useState)(!1),[m,x]=(0,a.useState)(null),[u,h]=(0,a.useState)({show:!1,message:"",type:""}),[p,g]=(0,a.useState)({title:"",description:"",type:"discount",value:0,minPoints:0,minSpent:0,validFrom:"",validTo:"",timeOfDay:"all",isActive:!0});(0,a.useEffect)(()=>{let e=(0,F.hg)(E.j2,e=>{e&&(i(e),b(e.uid))});return()=>e()},[]);let b=e=>{let t=(0,P.rJ)(E.db,"restaurants",e,"promotions"),r=(0,P.P)(t,(0,P.My)("createdAt","desc"));return(0,P.aQ)(r,e=>{let t=[];e.forEach(e=>{t.push({id:e.id,...e.data()})}),s(t),l(!1)})},j=()=>{g({title:"",description:"",type:"discount",value:0,minPoints:0,minSpent:0,validFrom:"",validTo:"",timeOfDay:"all",isActive:!0}),x(null)},f=()=>{j(),o(!0)},N=e=>{var s,t;x(e),g({title:e.title,description:e.description,type:e.type,value:e.value,minPoints:e.minPoints||0,minSpent:e.minSpent||0,validFrom:(null==(s=e.validFrom)?void 0:s.toDate)?new Date(e.validFrom.toDate()).toISOString().split("T")[0]:"",validTo:(null==(t=e.validTo)?void 0:t.toDate)?new Date(e.validTo.toDate()).toISOString().split("T")[0]:"",timeOfDay:e.timeOfDay||"all",isActive:e.isActive}),o(!0)},v=async()=>{if(!n||!p.title||!p.description)return void A("กรุณากรอกข้อมูลให้ครบถ้วน","error");try{let e={title:p.title,description:p.description,type:p.type,value:p.value,minPoints:p.minPoints||void 0,minSpent:p.minSpent||void 0,validFrom:p.validFrom?new Date(p.validFrom):null,validTo:p.validTo?new Date(p.validTo):null,timeOfDay:p.timeOfDay,isActive:p.isActive,restaurantId:n.uid,updatedAt:(0,P.O5)()};m?(await (0,P.mZ)((0,P.H9)(E.db,"restaurants",n.uid,"promotions",m.id),e),A("อัพเดทโปรโมชั่นสำเร็จ","success")):(await (0,P.gS)((0,P.rJ)(E.db,"restaurants",n.uid,"promotions"),{...e,createdAt:(0,P.O5)()}),A("เพิ่มโปรโมชั่นสำเร็จ","success")),o(!1),j()}catch(e){console.error("Error saving promotion:",e),A("เกิดข้อผิดพลาด","error")}},w=async e=>{if(n&&confirm("คุณต้องการลบโปรโมชั่นนี้หรือไม่?"))try{await (0,P.kd)((0,P.H9)(E.db,"restaurants",n.uid,"promotions",e)),A("ลบโปรโมชั่นสำเร็จ","success")}catch(e){console.error("Error deleting promotion:",e),A("เกิดข้อผิดพลาด","error")}},A=(e,s)=>{h({show:!0,message:e,type:s}),setTimeout(()=>{h({show:!1,message:"",type:""})},3e3)},k=e=>{switch(e){case"discount":return(0,r.jsx)(ea.A,{className:"h-4 w-4"});case"points_multiplier":return(0,r.jsx)(el.A,{className:"h-4 w-4"});default:return(0,r.jsx)(y.A,{className:"h-4 w-4"})}},C=e=>{switch(e){case"discount":return"ส่วนลด";case"points_multiplier":return"แต้มคูณ";case"free_item":return"ของแถม";default:return e}},S=e=>{switch(e){case"morning":return"เช้า (06:00-11:59)";case"afternoon":return"กลางวัน (12:00-17:59)";case"evening":return"เย็น (18:00-23:59)";default:return"ตลอดวัน"}};return t?(0,r.jsx)("div",{className:"flex justify-center items-center py-20",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500"})}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(y.A,{className:"h-6 w-6 text-purple-600 mr-2"}),(0,r.jsx)("h2",{className:"text-xl font-bold",children:"จัดการโปรโมชั่น"})]}),(0,r.jsxs)("button",{onClick:f,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 flex items-center",children:[(0,r.jsx)(O.A,{className:"h-4 w-4 mr-2"}),"เพิ่มโปรโมชั่น"]})]}),0===e.length?(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)(y.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"ยังไม่มีโปรโมชั่น"}),(0,r.jsx)("p",{className:"text-gray-500 mb-4",children:"สร้างโปรโมชั่นเพื่อดึงดูดลูกค้า"}),(0,r.jsx)("button",{onClick:f,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:"เพิ่มโปรโมชั่นแรก"})]}):(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.map(e=>(0,r.jsxs)("div",{className:"border rounded-lg p-4 ".concat(e.isActive?"border-purple-200 bg-purple-50":"border-gray-200 bg-gray-50"),children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"p-2 rounded-full mr-3 ".concat(e.isActive?"bg-purple-100":"bg-gray-100"),children:k(e.type)}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-bold text-gray-900",children:e.title}),(0,r.jsx)("span",{className:"text-xs px-2 py-1 rounded-full ".concat(e.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e.isActive?"เปิดใช้งาน":"ปิดใช้งาน"})]})]}),(0,r.jsxs)("div",{className:"flex space-x-1",children:[(0,r.jsx)("button",{onClick:()=>N(e),className:"p-1 text-blue-600 hover:bg-blue-100 rounded",children:(0,r.jsx)(L.A,{className:"h-4 w-4"})}),(0,r.jsx)("button",{onClick:()=>w(e.id),className:"p-1 text-red-600 hover:bg-red-100 rounded",children:(0,r.jsx)(es.A,{className:"h-4 w-4"})})]})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:e.description}),(0,r.jsxs)("div",{className:"space-y-2 text-xs text-gray-500",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"font-medium",children:"ประเภท:"}),(0,r.jsx)("span",{className:"ml-1",children:C(e.type)}),"discount"===e.type&&(0,r.jsxs)("span",{className:"ml-1",children:["(",e.value,"%)"]}),"points_multiplier"===e.type&&(0,r.jsxs)("span",{className:"ml-1",children:["(x",e.value,")"]})]}),e.minPoints&&e.minPoints>0&&(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"font-medium",children:"แต้มขั้นต่ำ:"}),(0,r.jsxs)("span",{className:"ml-1",children:[e.minPoints," แต้ม"]})]}),e.minSpent&&e.minSpent>0&&(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"font-medium",children:"ยอดซื้อขั้นต่ำ:"}),(0,r.jsxs)("span",{className:"ml-1",children:["฿",e.minSpent]})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(c.A,{className:"h-3 w-3 mr-1"}),(0,r.jsx)("span",{children:S(e.timeOfDay)})]}),e.validFrom&&e.validTo&&(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"font-medium",children:"ระยะเวลา:"}),(0,r.jsxs)("span",{className:"ml-1",children:[new Date(e.validFrom.toDate()).toLocaleDateString("th-TH")," -",new Date(e.validTo.toDate()).toLocaleDateString("th-TH")]})]})]})]},e.id))})]}),d&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:(0,r.jsx)("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsx)("h3",{className:"text-xl font-bold mb-6",children:m?"แก้ไขโปรโมชั่น":"เพิ่มโปรโมชั่นใหม่"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ชื่อโปรโมชั่น *"}),(0,r.jsx)("input",{type:"text",value:p.title,onChange:e=>g({...p,title:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"เช่น ลด 20% สำหรับสมาชิก Gold"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"รายละเอียด *"}),(0,r.jsx)("textarea",{value:p.description,onChange:e=>g({...p,description:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",rows:3,placeholder:"อธิบายรายละเอียดโปรโมชั่น"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ประเภทโปรโมชั่น"}),(0,r.jsxs)("select",{value:p.type,onChange:e=>g({...p,type:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",children:[(0,r.jsx)("option",{value:"discount",children:"ส่วนลด (%)"}),(0,r.jsx)("option",{value:"points_multiplier",children:"แต้มคูณ"}),(0,r.jsx)("option",{value:"free_item",children:"ของแถม"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["ค่า ","discount"===p.type?"(เปอร์เซ็นต์)":"points_multiplier"===p.type?"(ตัวคูณ)":""]}),(0,r.jsx)("input",{type:"number",value:p.value,onChange:e=>g({...p,value:Number(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",min:"0",max:"discount"===p.type?"100":void 0})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"แต้มขั้นต่ำ"}),(0,r.jsx)("input",{type:"number",value:p.minPoints,onChange:e=>g({...p,minPoints:Number(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",min:"0"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ยอดซื้อขั้นต่ำ (บาท)"}),(0,r.jsx)("input",{type:"number",value:p.minSpent,onChange:e=>g({...p,minSpent:Number(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",min:"0"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ช่วงเวลาใช้งาน"}),(0,r.jsxs)("select",{value:p.timeOfDay,onChange:e=>g({...p,timeOfDay:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",children:[(0,r.jsx)("option",{value:"all",children:"ตลอดวัน"}),(0,r.jsx)("option",{value:"morning",children:"เช้า (06:00-11:59)"}),(0,r.jsx)("option",{value:"afternoon",children:"กลางวัน (12:00-17:59)"}),(0,r.jsx)("option",{value:"evening",children:"เย็น (18:00-23:59)"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"วันที่เริ่ม"}),(0,r.jsx)("input",{type:"date",value:p.validFrom,onChange:e=>g({...p,validFrom:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"วันที่สิ้นสุด"}),(0,r.jsx)("input",{type:"date",value:p.validTo,onChange:e=>g({...p,validTo:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500"})]})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",id:"isActive",checked:p.isActive,onChange:e=>g({...p,isActive:e.target.checked}),className:"h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded"}),(0,r.jsx)("label",{htmlFor:"isActive",className:"ml-2 text-sm text-gray-700",children:"เปิดใช้งานโปรโมชั่น"})]})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,r.jsx)("button",{onClick:()=>o(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"ยกเลิก"}),(0,r.jsxs)("button",{onClick:v,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:[m?"อัพเดท":"เพิ่ม","โปรโมชั่น"]})]})]})})}),u.show&&(0,r.jsx)("div",{className:"fixed bottom-4 right-4 px-6 py-3 rounded-lg shadow-lg z-50 ".concat("success"===u.type?"bg-green-500":"bg-red-500"," text-white"),children:u.message})]})}function ei(){let[e,s]=(0,a.useState)("overview"),[t,O]=(0,a.useState)(!1),[T,U]=(0,a.useState)(!1),[_,R]=(0,a.useState)(!1),[L,I]=(0,a.useState)(null),[H,q]=(0,a.useState)({restaurantName:"",phoneNumber:"",email:"",storeName:"",phone:""}),[z,J]=(0,a.useState)({show:!1,message:"",type:""}),Q=(0,D.useRouter)(),[G,B]=(0,a.useState)([]),[V,W]=(0,a.useState)([]),[$,ee]=(0,a.useState)(0),[es,ea]=(0,a.useState)(0),[el,ei]=(0,a.useState)([]),[ec,ed]=(0,a.useState)(!1),[eo,em]=(0,a.useState)(!1),[ex,eu]=(0,a.useState)(0),eh=(0,a.useRef)(null),[ep,eg]=(0,a.useState)([]),[eb,ej]=(0,a.useState)([]);(0,a.useEffect)(()=>{let e=(0,F.hg)(E.j2,async e=>{if(e){let s=(0,P.H9)(E.db,"users",e.uid),t=await (0,P.x7)(s);if(!t.exists())return void Q.push("/setup");if(!t.data().isPaid)return void Q.push("/pricing");I(e),ef(e.uid),ey(e.uid)}else Q.push("/login")});return()=>e()},[Q]),(0,a.useEffect)(()=>{let e;if(L){let s=(0,P.P)((0,P.rJ)(E.db,"users",L.uid,"call_staff"),(0,P._M)("status","==","pending"),(0,P.My)("createdAt","desc"));e=(0,P.aQ)(s,e=>{let s=[];e.forEach(e=>{s.push({id:e.id,...e.data()})}),ej(s)})}return()=>{e&&e()}},[L]);let ey=e=>{let s=(0,P.P)((0,P.rJ)(E.db,"users",e,"menu"),(0,P._M)("isRecommended","==",!0),(0,P._M)("isAvailable","==",!0)),t=(0,P.aQ)(s,e=>{let s=[];e.forEach(e=>{s.push({id:e.id,...e.data()})}),B(s)},e=>{console.error("Error in menu real-time listener:",e)}),r=new Date;r.setHours(0,0,0,0);let a=(0,P.P)((0,P.rJ)(E.db,"users",e,"orders"),(0,P._M)("status","==","pending")),l=(0,P.aQ)(a,e=>{let s=[];e.forEach(e=>{s.push({id:e.id,...e.data()})}),W(s)},e=>{console.error("Error in orders real-time listener:",e)}),n=(0,P.P)((0,P.rJ)(E.db,"users",e,"orders"),(0,P._M)("createdAt",">=",r),(0,P._M)("status","==","completed")),i=(0,P.aQ)(n,e=>{let s=0,t=0;e.forEach(e=>{let r=e.data();s+=r.totalAmount||0,t++}),ee(s),ea(t)},e=>{console.error("Error in revenue real-time listener:",e)}),c=async()=>{try{let s=new Date;s.setDate(s.getDate()-7);let t=(0,P.P)((0,P.rJ)(E.db,"users",e,"orders"),(0,P._M)("status","==","completed"),(0,P._M)("createdAt",">=",s),(0,P.My)("createdAt","asc")),r=(await (0,P.GG)(t)).docs.reduce((e,s)=>{var t;let r=s.data(),a=(null==(t=r.createdAt)?void 0:t.toDate)?new Date(r.createdAt.toDate()).toISOString().split("T")[0]:new Date().toISOString().split("T")[0];return e[a]||(e[a]=0),e[a]+=r.totalAmount||0,e},{}),a=Object.entries(r).map(e=>{let[s,t]=e;return{date:s,amount:t}});ei(a)}catch(e){console.error("Error fetching weekly revenue:",e)}},d=async()=>{try{let s=new Date;s.setDate(s.getDate()-7);let t=(0,P.P)((0,P.rJ)(E.db,"users",e,"orders"),(0,P._M)("status","==","completed"),(0,P._M)("createdAt",">=",s)),r=await (0,P.GG)(t),a={};r.forEach(e=>{let s=e.data();s.items&&s.items.forEach(e=>{a[e.id]||(a[e.id]={name:e.name,count:0,revenue:0}),a[e.id].count+=e.quantity,a[e.id].revenue+=e.price*e.quantity,e.selectedOptions&&e.selectedOptions.forEach(s=>{a[e.id].revenue+=s.price*e.quantity})})});let l=Object.entries(a).map(e=>{let[s,t]=e;return{id:s,...t}}).sort((e,s)=>s.count-e.count).slice(0,5);eg(l)}catch(e){console.error("Error fetching popular menu items:",e)}};c(),d();let o=setInterval(()=>{c(),d()},36e5);return()=>{t(),l(),i(),clearInterval(o)}},ef=async e=>{try{R(!0);let s=(0,P.H9)(E.db,"users",e);return(0,P.aQ)(s,e=>{if(e.exists()){let s=e.data();q({restaurantName:s.restaurantName||"",phoneNumber:s.phoneNumber||"",email:s.email||"",storeName:s.storeName||"",phone:s.phone||""})}R(!1)},e=>{console.error("Error in profile real-time listener:",e),ew("ไม่สามารถโหลดข้อมูลโปรไฟล์ได้","error"),R(!1)})}catch(e){return console.error("Error fetching user profile:",e),ew("ไม่สามารถโหลดข้อมูลโปรไฟล์ได้","error"),R(!1),()=>{}}},eN=async()=>{if(L)try{R(!0);let e=(0,P.H9)(E.db,"users",L.uid);await (0,P.mZ)(e,{restaurantName:H.restaurantName,phoneNumber:H.phoneNumber,storeName:H.storeName,phone:H.phone,updatedAt:(0,P.O5)()}),ew("อัปเดตข้อมูลโปรไฟล์สำเร็จ","success"),U(!1)}catch(e){console.error("Error updating profile:",e),ew("ไม่สามารถอัปเดตข้อมูลโปรไฟล์ได้","error")}finally{R(!1)}},ev=async()=>{try{await (0,F.CI)(E.j2),Q.push("/login")}catch(e){console.error("Error signing out:",e)}},ew=(e,s)=>{J({show:!0,message:e,type:s}),setTimeout(()=>{J({show:!1,message:"",type:""})},3e3)},eA=e=>{let{name:s,value:t}=e.target;q(e=>({...e,[s]:t}))};(0,a.useEffect)(()=>(eh.current=new Audio("/notification.mp3"),()=>{eh.current&&(eh.current=null)}),[]),(0,a.useEffect)(()=>{V.length>ex&&ex>0&&(eh.current&&eh.current.play().catch(e=>console.error("Error playing notification sound:",e)),ew("มีออเดอร์ใหม่ ".concat(V.length-ex," รายการ"),"success")),eu(V.length)},[V.length]),(0,a.useEffect)(()=>{let e=e=>{e.ctrlKey&&e.shiftKey&&"D"===e.key&&(e.preventDefault(),em(e=>!e))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]);let ek=(e,s,t)=>(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 px-4 text-center",children:[(0,r.jsx)("div",{className:"bg-gray-100 p-4 rounded-full mb-4",children:t}),(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:e}),(0,r.jsx)("p",{className:"text-sm text-gray-500 max-w-md mb-6",children:s})]}),eC=e=>{let{data:s}=e;if(!s||0===s.length)return null;let t=Math.max(...s.map(e=>e.amount));return(0,r.jsxs)("div",{className:"relative h-64 w-full mt-4",children:[(0,r.jsx)("div",{className:"flex items-end justify-between h-full w-full",children:s.map((e,s)=>{let a=e.amount/t*200||0,l=new Date(e.date).toLocaleDateString("th-TH",{day:"numeric",month:"short"});return(0,r.jsxs)("div",{className:"flex flex-col items-center",style:{flex:"1"},children:[(0,r.jsx)("div",{className:"bg-blue-500 rounded-t-sm w-12 transition-all duration-500 ease-in-out",style:{height:"".concat(a,"px")},title:"฿".concat(e.amount.toFixed(2))}),(0,r.jsx)("div",{className:"text-xs text-gray-600 mt-2 rotate-45 origin-left",children:l})]},s)})}),(0,r.jsxs)("div",{className:"absolute left-0 top-0 h-full flex flex-col justify-between text-xs text-gray-500",children:[(0,r.jsxs)("span",{children:["฿",t.toFixed(0)]}),(0,r.jsxs)("span",{children:["฿",(t/2).toFixed(0)]}),(0,r.jsx)("span",{children:"฿0"})]})]})};return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[(0,r.jsx)("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-20 md:hidden",children:(0,r.jsxs)("div",{className:"flex items-center justify-between px-4 py-3",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("button",{className:"text-gray-500 hover:text-gray-700 mr-2",onClick:()=>O(!0),children:(0,r.jsx)(u.A,{className:"h-6 w-6"})}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"h-8 w-8 rounded-md bg-blue-600 flex items-center justify-center text-white mr-2",children:(0,r.jsx)(n.A,{className:"h-5 w-5"})}),(0,r.jsx)("h1",{className:"text-lg font-bold",children:H.storeName||"ร้านอาหาร"})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("button",{onClick:()=>s("orders"),className:"text-gray-500 hover:text-gray-700",children:(0,r.jsx)(h.A,{className:"h-6 w-6"})}),V.length>0&&(0,r.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs font-medium px-1.5 py-0.5 rounded-full",children:V.length})]}),(0,r.jsx)("button",{onClick:()=>U(!0),children:(0,r.jsx)("img",{src:"/placeholder.svg?height=32&width=32",alt:"Profile",className:"h-8 w-8 rounded-full object-cover"})})]})]})}),t&&(0,r.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 z-20 md:hidden",onClick:()=>O(!1)}),(0,r.jsxs)("div",{className:"bg-white border-r border-gray-200 w-64 fixed inset-y-0 left-0 z-30 transition-transform duration-300 ease-in-out transform ".concat(t?"translate-x-0":"-translate-x-full"," md:translate-x-0"),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"h-8 w-8 rounded-md bg-blue-600 flex items-center justify-center text-white mr-2",children:(0,r.jsx)(n.A,{className:"h-5 w-5"})}),(0,r.jsx)("h1",{className:"text-xl font-bold",children:H.storeName||"ร้านอาหาร"})]}),(0,r.jsx)("button",{className:"md:hidden text-gray-500 hover:text-gray-700",onClick:()=>O(!1),children:(0,r.jsx)(p.A,{className:"h-5 w-5"})})]}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("button",{className:"w-full flex items-center px-3 py-2 rounded-md ".concat("overview"===e?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-100"),onClick:()=>{s("overview"),O(!1)},children:[(0,r.jsx)(i.A,{className:"h-5 w-5 mr-3"}),(0,r.jsx)("span",{children:"ภาพรวม"})]}),(0,r.jsxs)("button",{className:"w-full flex items-center justify-between px-3 py-2 rounded-md ".concat("orders"===e?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-100"),onClick:()=>{s("orders"),O(!1)},children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(d.A,{className:"h-5 w-5 mr-3"}),(0,r.jsx)("span",{children:"ออเดอร์"})]}),V.length>0&&(0,r.jsx)("span",{className:"bg-red-500 text-white text-xs font-medium px-2 py-0.5 rounded-full",children:V.length})]}),(0,r.jsxs)("button",{className:"w-full flex items-center px-3 py-2 rounded-md ".concat("menu"===e?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-100"),onClick:()=>{s("menu"),O(!1)},children:[(0,r.jsx)(n.A,{className:"h-5 w-5 mr-3"}),(0,r.jsx)("span",{children:"เมนู"})]}),(0,r.jsxs)("button",{className:"w-full flex items-center px-3 py-2 rounded-md ".concat("qrcode"===e?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-100"),onClick:()=>{s("qrcode"),O(!1)},children:[(0,r.jsx)(g.A,{className:"h-5 w-5 mr-3"}),(0,r.jsx)("span",{children:"QR Code"})]}),(0,r.jsxs)("button",{className:"w-full flex items-center px-3 py-2 rounded-md ".concat("revenue"===e?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-100"),onClick:()=>{s("revenue"),O(!1)},children:[(0,r.jsx)(l.A,{className:"h-5 w-5 mr-3"}),(0,r.jsx)("span",{children:"รายได้"})]}),(0,r.jsxs)("button",{className:"w-full flex items-center px-3 py-2 rounded-md ".concat("bills"===e?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-100"),onClick:()=>{s("bills"),O(!1)},children:[(0,r.jsx)(b.A,{className:"h-5 w-5 mr-3"}),(0,r.jsx)("span",{children:"บิล"})]}),(0,r.jsxs)("button",{className:"w-full flex items-center px-3 py-2 rounded-md ".concat("qr-settings"===e?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-100"),onClick:()=>{s("qr-settings"),O(!1)},children:[(0,r.jsx)(g.A,{className:"h-5 w-5 mr-3"}),(0,r.jsx)("span",{children:"ตั้งค่า QR Code"})]}),(0,r.jsxs)("button",{className:"w-full flex items-center px-3 py-2 rounded-md ".concat("receipts"===e?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-100"),onClick:()=>{s("receipts"),O(!1)},children:[(0,r.jsx)(b.A,{className:"h-5 w-5 mr-3"}),(0,r.jsx)("span",{children:"ใบเสร็จลูกค้า"})]}),(0,r.jsxs)("button",{className:"w-full flex items-center px-3 py-2 rounded-md ".concat("members"===e?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-100"),onClick:()=>{s("members"),O(!1)},children:[(0,r.jsx)(j.A,{className:"h-5 w-5 mr-3"}),(0,r.jsx)("span",{children:"จัดการสมาชิก"})]}),(0,r.jsxs)("button",{className:"w-full flex items-center px-3 py-2 rounded-md ".concat("promotions"===e?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-100"),onClick:()=>{s("promotions"),O(!1)},children:[(0,r.jsx)(y.A,{className:"h-5 w-5 mr-3"}),(0,r.jsx)("span",{children:"จัดการโปรโมชั่น"})]}),(0,r.jsxs)("button",{className:"w-full flex items-center px-3 py-2 rounded-md ".concat("call-staff"===e?"bg-orange-50 text-orange-700":"text-gray-700 hover:bg-gray-100"),onClick:()=>{s("call-staff"),O(!1)},children:[(0,r.jsx)(h.A,{className:"h-5 w-5 mr-3 text-orange-500"}),(0,r.jsx)("span",{children:"เรียกพนักงาน"}),eb.length>0&&(0,r.jsx)("span",{className:"bg-red-500 text-white text-xs font-bold px-2 py-0.5 rounded-full ml-2",children:eb.length})]})]}),(0,r.jsxs)("div",{className:"mt-8",children:[(0,r.jsx)("p",{className:"px-3 text-xs font-medium text-gray-400 uppercase mb-2",children:"บัญชี"}),(0,r.jsxs)("button",{className:"w-full flex items-center px-3 py-2 rounded-md text-gray-700 hover:bg-gray-100",onClick:()=>{U(!0),O(!1)},children:[(0,r.jsx)(f.A,{className:"h-5 w-5 mr-3"}),(0,r.jsx)("span",{children:"ตั้งค่าโปรไฟล์"})]}),(0,r.jsxs)("button",{className:"w-full flex items-center px-3 py-2 rounded-md text-gray-700 hover:bg-gray-100",onClick:ev,children:[(0,r.jsx)(N.A,{className:"h-5 w-5 mr-3"}),(0,r.jsx)("span",{children:"ออกจากระบบ"})]})]})]})]}),(0,r.jsxs)("div",{className:"flex-1 md:ml-64",children:[(0,r.jsx)("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-10 hidden md:block",children:(0,r.jsxs)("div",{className:"flex items-center justify-between px-6 py-3",children:[(0,r.jsx)("h2",{className:"text-lg font-bold",children:(e=>{switch(e){case"overview":return"ภาพรวม";case"qrcode":return"สร้าง QR Code";case"orders":return"ออเดอร์";case"revenue":return"รายได้";case"menu":return"จัดการเมนู";case"bills":return"จัดการบิล";case"qr-settings":return"ตั้งค่า QR Code รับเงิน";case"receipts":return"ใบเสร็จลูกค้า";case"members":return"จัดการสมาชิก";case"promotions":return"จัดการโปรโมชั่น";default:return""}})(e)}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("button",{onClick:()=>s("orders"),className:"text-gray-500 hover:text-gray-700",children:(0,r.jsx)(h.A,{className:"h-6 w-6"})}),V.length>0&&(0,r.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs font-medium px-1.5 py-0.5 rounded-full",children:V.length})]}),(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsxs)("button",{className:"flex items-center space-x-2 focus:outline-none",onClick:()=>U(!0),children:[(0,r.jsxs)("div",{className:"hidden md:block text-left",children:[(0,r.jsx)("p",{className:"text-sm font-medium",children:H.storeName||"ร้านอาหารของคุณ"}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:H.phone||H.phoneNumber||"เบอร์โทรศัพท์"})]}),(0,r.jsx)(v.A,{className:"h-4 w-4 text-gray-500"})]})})]})]})}),(0,r.jsxs)("main",{className:"p-4 md:p-6",children:[(()=>{switch(e){case"overview":return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6",children:[(0,r.jsx)("div",{className:"bg-white p-4 md:p-6 rounded-xl shadow-sm border border-gray-100",children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"รายได้วันนี้"}),(0,r.jsxs)("h3",{className:"text-xl md:text-2xl font-bold mt-1",children:["฿",$.toFixed(2)]})]}),(0,r.jsx)("div",{className:"p-2 bg-green-50 rounded-lg",children:(0,r.jsx)(l.A,{className:"h-5 w-5 md:h-6 md:w-6 text-green-500"})})]})}),(0,r.jsx)("div",{className:"bg-white p-4 md:p-6 rounded-xl shadow-sm border border-gray-100",children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"จำนวนออเดอร์ที่เสร็จสิ้น"}),(0,r.jsx)("h3",{className:"text-xl md:text-2xl font-bold mt-1",children:es})]}),(0,r.jsx)("div",{className:"p-2 bg-blue-50 rounded-lg",children:(0,r.jsx)(n.A,{className:"h-5 w-5 md:h-6 md:w-6 text-blue-500"})})]})}),(0,r.jsx)("div",{className:"bg-white p-4 md:p-6 rounded-xl shadow-sm border border-gray-100",children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"มูลค่าเฉลี่ยต่อออเดอร์"}),(0,r.jsxs)("h3",{className:"text-xl md:text-2xl font-bold mt-1",children:["฿",es>0?($/es).toFixed(2):"0.00"]})]}),(0,r.jsx)("div",{className:"p-2 bg-purple-50 rounded-lg",children:(0,r.jsx)(i.A,{className:"h-5 w-5 md:h-6 md:w-6 text-purple-500"})})]})}),(0,r.jsx)("div",{className:"bg-white p-4 md:p-6 rounded-xl shadow-sm border border-gray-100",children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"ออเดอร์ที่รอยืนยัน"}),(0,r.jsx)("h3",{className:"text-xl md:text-2xl font-bold mt-1",children:V.length})]}),(0,r.jsx)("div",{className:"p-2 bg-amber-50 rounded-lg",children:(0,r.jsx)(c.A,{className:"h-5 w-5 md:h-6 md:w-6 text-amber-500"})})]})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,r.jsxs)("div",{className:"lg:col-span-2 bg-white p-4 md:p-6 rounded-xl shadow-sm border border-gray-100",children:[(0,r.jsx)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6",children:(0,r.jsx)("h3",{className:"font-bold mb-2 sm:mb-0",children:"รายได้"})}),el.length>0?(0,r.jsx)(eC,{data:el}):ek("ยังไม่มีข้อมูลรายได้","รายได้จะแสดงเมื่อมีออเดอร์ที่เสร็จสิ้นแล้วเท่านั้น",(0,r.jsx)(i.A,{className:"h-8 w-8 text-gray-400"}))]}),(0,r.jsxs)("div",{className:"bg-white p-4 md:p-6 rounded-xl shadow-sm border border-gray-100 h-[500px] overflow-y-auto",children:[(0,r.jsx)("h3",{className:"font-bold mb-4",children:"ออเดอร์ที่รอการยืนยัน"}),V.length>0?(0,r.jsx)("div",{className:"space-y-3",children:V.map(e=>{var t,a;return(0,r.jsxs)("div",{className:"border border-gray-200 rounded-lg p-3",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,r.jsxs)("span",{className:"font-medium",children:["โต๊ะ ",e.table||"-"]}),(0,r.jsx)("span",{className:"bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full text-xs",children:"รอยืนยัน"})]}),(0,r.jsxs)("p",{className:"text-sm text-gray-500 mb-2",children:[(null==(t=e.items)?void 0:t.length)||0," รายการ \xb7 ฿",(null==(a=e.totalAmount)?void 0:a.toFixed(2))||"0"]}),(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsx)("button",{className:"px-3 py-1 bg-blue-600 text-white text-xs rounded-md",onClick:()=>s("orders"),children:"ดูรายละเอียด"})})]},e.id)})}):ek("ไม่มีออเดอร์ที่รอการยืนยัน","ออเดอร์ใหม่จะปรากฏที่นี่เมื่อลูกค้าสั่งอาหาร",(0,r.jsx)(d.A,{className:"h-8 w-8 text-gray-400"}))]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 h-[500px] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"bg-white p-4 md:p-6 rounded-xl shadow-sm border border-gray-100",children:[(0,r.jsx)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6",children:(0,r.jsx)("h3",{className:"font-bold mb-2 sm:mb-0",children:"เมนูยอดนิยม "})}),ep.length>0?(0,r.jsx)("div",{className:"space-y-3",children:ep.map((e,s)=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3",children:(0,r.jsxs)("span",{className:"text-blue-600 font-bold text-sm",children:["#",s+1]})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium text-gray-900",children:e.name}),(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:["สั่ง ",e.count," ครั้ง"]})]})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsxs)("div",{className:"text-sm font-medium text-green-600",children:["฿",e.revenue.toFixed(2)]}),(0,r.jsx)("div",{className:"text-xs text-gray-500",children:"รายได้"})]})]},e.id))}):ek("ยังไม่มีข้อมูลเมนูยอดนิยม","ข้อมูลจะแสดงเมื่อมีออเดอร์ที่เสร็จสิ้นแล้ว",(0,r.jsx)(o.A,{className:"h-8 w-8 text-gray-400"}))]}),(0,r.jsxs)("div",{className:"bg-white p-4 md:p-6 rounded-xl shadow-sm border border-gray-100 h-[500px] overflow-y-auto",children:[(0,r.jsx)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6",children:(0,r.jsx)("h3",{className:"font-bold mb-2 sm:mb-0",children:"เมนูแนะนำ"})}),G.length>0?(0,r.jsx)("div",{className:"space-y-3",children:G.slice(0,4).map(e=>{var s;return(0,r.jsxs)("div",{className:"flex items-center p-3 border border-gray-200 rounded-lg",children:[(0,r.jsx)("div",{className:"w-12 h-12 bg-gray-100 rounded-lg mr-3 overflow-hidden",children:e.imageUrl?(0,r.jsx)("img",{src:e.imageUrl||"/placeholder.svg",alt:e.name,className:"w-full h-full object-cover"}):(0,r.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,r.jsx)(n.A,{className:"h-6 w-6 text-gray-400"})})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h4",{className:"font-medium text-gray-900",children:e.name}),(0,r.jsxs)("div",{className:"flex justify-between items-center mt-1",children:[(0,r.jsxs)("span",{className:"text-blue-600 font-medium",children:["฿",null==(s=e.price)?void 0:s.toFixed(2)]}),(0,r.jsx)("span",{className:"text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full",children:"แนะนำ"})]})]})]},e.id)})}):ek("ยังไม่มีเมนูแนะนำ","เพิ่มเมนูแนะนำเพื่อแสดงที่นี่",(0,r.jsx)(m.A,{className:"h-8 w-8 text-gray-400"}))]})]})]});case"call-staff":return(0,r.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-orange-200",children:[(0,r.jsxs)("div",{className:"flex items-center mb-3",children:[(0,r.jsx)("span",{className:"text-2xl mr-2",children:"\uD83D\uDEA8"}),(0,r.jsx)("h3",{className:"font-bold text-orange-600",children:"แจ้งเตือนเรียกพนักงาน"})]}),0===eb.length?(0,r.jsx)("div",{className:"text-gray-500",children:"ยังไม่มีการเรียกพนักงาน"}):(0,r.jsx)("ul",{className:"space-y-2",children:eb.map(e=>{var s;return(0,r.jsxs)("li",{className:"flex justify-between items-center border p-3 rounded bg-orange-50",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"font-bold",children:["โต๊ะ ",e.table]}),(0,r.jsx)("div",{className:"text-xs text-gray-500",children:(null==(s=e.createdAt)?void 0:s.toDate)?new Date(e.createdAt.toDate()).toLocaleTimeString("th-TH"):""})]}),(0,r.jsx)("button",{className:"bg-green-500 text-white px-4 py-1 rounded hover:bg-green-600 font-bold",onClick:async()=>{await (0,P.kd)((0,P.H9)(E.db,"users",L.uid,"call_staff",e.id)),ew("รับเรื่องเรียกพนักงานแล้ว","success")},children:"รับเรื่องแล้ว"})]},e.id)})})]});case"qrcode":return(0,r.jsx)(K.A,{});case"orders":return(0,r.jsx)(Z,{});case"revenue":return(0,r.jsx)("div",{className:"space-y-6",children:(0,r.jsxs)("div",{className:"bg-white p-4 md:p-6 rounded-xl shadow-sm border border-gray-100",children:[(0,r.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-6",children:[(0,r.jsx)("h2",{className:"text-lg md:text-xl font-bold mb-4 md:mb-0",children:"สรุปรายได้"}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,r.jsx)("button",{className:"px-3 py-1.5 bg-blue-600 text-white text-xs md:text-sm rounded-md",children:"วันนี้"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:"date",className:"pl-3 pr-10 py-1.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-xs md:text-sm"}),(0,r.jsx)(x.A,{className:"h-4 w-4 absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 md:gap-6 mb-8",children:[(0,r.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,r.jsx)("p",{className:"text-xs md:text-sm text-blue-700",children:"รายได้รวม"}),(0,r.jsxs)("h3",{className:"text-xl md:text-2xl font-bold text-blue-900 mt-1",children:["฿",$.toFixed(2)]})]}),(0,r.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg",children:[(0,r.jsx)("p",{className:"text-xs md:text-sm text-green-700",children:"จำนวนออเดอร์"}),(0,r.jsx)("h3",{className:"text-xl md:text-2xl font-bold text-green-900 mt-1",children:es})]}),(0,r.jsxs)("div",{className:"bg-purple-50 p-4 rounded-lg",children:[(0,r.jsx)("p",{className:"text-xs md:text-sm text-purple-700",children:"มูลค่าเฉลี่ยต่อออเดอร์"}),(0,r.jsxs)("h3",{className:"text-xl md:text-2xl font-bold text-purple-900 mt-1",children:["฿",es>0?($/es).toFixed(2):"0.00"]})]})]}),(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h3",{className:"font-bold mb-4",children:"รายได้ตามช่วงเวลา"}),el.length>0?(0,r.jsx)(eC,{data:el}):ek("ยังไม่มีข้อมูลรายได้","เริ่มรับออเดอร์เพื่อดูข้อมูลรายได้ตามช่วงเวลา",(0,r.jsx)(i.A,{className:"h-8 w-8 text-gray-400"}))]})]})});case"menu":return(0,r.jsx)(M,{});case"bills":return(0,r.jsx)(X,{});case"qr-settings":return(0,r.jsx)(Y,{});case"receipts":return(0,r.jsx)(et,{});case"call-staff":return"เรียกพนักงาน";case"members":return(0,r.jsx)(er,{});case"promotions":return(0,r.jsx)(en,{});default:return(0,r.jsx)("div",{children:"เลือกเมนูเพื่อดูข้อมูล"})}})(),eo&&!1]})]}),T&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:(0,r.jsx)("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h3",{className:"text-xl font-bold",children:"ตั้งค่าโปรไฟล์"}),(0,r.jsx)("button",{className:"text-gray-500 hover:text-gray-700",onClick:()=>U(!1),children:(0,r.jsx)(p.A,{className:"h-5 w-5"})})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ชื่อร้านอาหาร"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(w.A,{className:"h-5 w-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,r.jsx)("input",{type:"text",name:"storeName",value:H.storeName,onChange:eA,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"ชื่อร้านอาหารของคุณ"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"เบอร์โทรศัพท์"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(A.A,{className:"h-5 w-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,r.jsx)("input",{type:"tel",name:"phone",value:H.phone,onChange:eA,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"เบอร์โทรศัพท์"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"อีเมล"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(k.A,{className:"h-5 w-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,r.jsx)("input",{type:"email",name:"email",value:H.email,disabled:!0,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md bg-gray-50 cursor-not-allowed"})]}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"ไม่สามารถเปลี่ยนอีเมลได้"})]})]}),(0,r.jsxs)("div",{className:"mt-8 flex justify-end space-x-3",children:[(0,r.jsx)("button",{className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700",onClick:()=>U(!1),children:"ยกเลิก"}),(0,r.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center",onClick:eN,disabled:_,children:_?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(C.A,{className:"h-4 w-4 mr-2 animate-spin"}),"กำลังบันทึก..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(S.A,{className:"h-4 w-4 mr-2"}),"บันทึก"]})})]})]})})}),z.show&&(0,r.jsx)("div",{className:"fixed bottom-4 right-4 px-6 py-3 rounded-lg shadow-lg z-50 ".concat("success"===z.type?"bg-green-500":"bg-red-500"," text-white"),children:z.message})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[992,122,234,955,977,822,583,441,684,358],()=>s(4907)),_N_E=e.O()}]);