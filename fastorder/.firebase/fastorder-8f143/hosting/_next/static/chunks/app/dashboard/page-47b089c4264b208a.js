(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{829:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>z});var r=t(5155),a=t(2115),l=t(4616),c=t(5868),d=t(5747),n=t(2713),i=t(4186),o=t(7434),m=t(8564),x=t(9074),u=t(7580),h=t(4783),p=t(3861),g=t(4416),b=t(7939),j=t(381),y=t(4835),f=t(6474),N=t(5937),v=t(9420),w=t(8883),A=t(4631),k=t(4229),C=t(5695),S=t(5610),E=t(5317),R=t(6203),F=t(7924),_=t(6932),U=t(1492),M=t(858);function D(){let[e,s]=(0,a.useState)([]),[t,c]=(0,a.useState)(!1),[d,n]=(0,a.useState)(null),[i,o]=(0,a.useState)(null),[m,x]=(0,a.useState)({show:!1,message:"",type:""}),[u,h]=(0,a.useState)(""),[p,b]=(0,a.useState)("all"),[j,y]=(0,a.useState)("name"),[f,N]=(0,a.useState)("asc"),[v,w]=(0,a.useState)([]),[D,L]=(0,a.useState)(null),[P,H]=(0,a.useState)(!1),[J,O]=(0,a.useState)({name:"",description:"",price:"",category:"",isAvailable:!0,isRecommended:!1,imageUrl:"",imageFile:null}),z=(0,C.useRouter)();(0,a.useEffect)(()=>{let e=(0,R.hg)(S.j2,e=>{e?(o(e.uid),G(e.uid),q(e.uid)):z.push("/login")});return()=>e()},[z]);let G=async e=>{try{let s=await (0,E.GG)((0,E.P)((0,E.rJ)(S.db,"users"),(0,E._M)("__name__","==",e)));if(!s.empty){let e=s.docs[0].data();n({storeName:e.storeName||"",restaurantName:e.restaurantName||"",phone:e.phone||"",phoneNumber:e.phoneNumber||""})}}catch(e){console.error("Error fetching user profile:",e),$("ไม่สามารถโหลดข้อมูลโปรไฟล์ได้","error")}},q=e=>{try{c(!0);let t=(0,E.P)((0,E.rJ)(S.db,"users",e,"menu"),(0,E.My)(j,"asc"===f?"asc":"desc"));return(0,E.aQ)(t,e=>{let t=[],r=new Set;e.forEach(e=>{let s=e.data();t.push({id:e.id,...s}),s.category&&r.add(s.category)}),s(t),w(Array.from(r)),c(!1)},e=>{console.error("Error in menu real-time listener:",e),$("ไม่สามารถโหลดเมนูได้","error"),c(!1)})}catch(e){return console.error("Error setting up menu listener:",e),$("ไม่สามารถโหลดเมนูได้","error"),c(!1),()=>{}}},Q=async e=>{},T=async e=>{if(!i||!e)return"";let s=(0,M.c7)(),t=e.name.split(".").pop(),r="menu_".concat(Date.now(),".").concat(t),a=(0,M.KR)(s,"users/".concat(i,"/menu/").concat(r));return await (0,M.D)(a,e),await (0,M.qk)(a)},I=async()=>{if(i){if(!J.name||!J.price)return void $("กรุณากรอกชื่อเมนูและราคา","error");try{c(!0);let e="";J.imageFile&&(e=await T(J.imageFile));let s={name:J.name,description:J.description,price:Number.parseFloat(J.price),category:J.category,isAvailable:J.isAvailable,isRecommended:J.isRecommended,imageUrl:e,userId:i,storeName:(null==d?void 0:d.storeName)||"",restaurantName:(null==d?void 0:d.restaurantName)||"",createdAt:(0,E.O5)()};await (0,E.gS)((0,E.rJ)(S.db,"users",i,"menu"),s),W(),H(!1),$("เพิ่มเมนูสำเร็จ","success"),Q(i)}catch(e){console.error("Error adding menu item:",e),$("ไม่สามารถเพิ่มเมนูได้","error")}finally{c(!1)}}},K=async()=>{if(i&&D)try{c(!0);let e=J.imageUrl;if(J.imageFile){if(D.imageUrl&&D.imageUrl.includes("firebase"))try{let e=(0,M.c7)(),s=(0,M.KR)(e,D.imageUrl);await (0,M.XR)(s)}catch(e){console.error("Error deleting old image:",e)}e=await T(J.imageFile)}let s={name:J.name,description:J.description,price:Number.parseFloat(J.price),category:J.category,isAvailable:J.isAvailable,isRecommended:J.isRecommended,imageUrl:e,updatedAt:(0,E.O5)()};await (0,E.mZ)((0,E.H9)(S.db,"users",i,"menu",D.id),s),W(),H(!1),$("อัปเดตเมนูสำเร็จ","success"),Q(i)}catch(e){console.error("Error updating menu item:",e),$("ไม่สามารถอัปเดตเมนูได้","error")}finally{c(!1)}},Z=async e=>{if(i&&confirm("คุณต้องการลบเมนูนี้ใช่หรือไม่?"))try{c(!0),(0,E.H9)(S.db,"users",i,"menu",e);let s=await (0,E.GG)((0,E.P)((0,E.rJ)(S.db,"users",i,"menu"),(0,E._M)("__name__","==",e)));if(!s.empty){let e=s.docs[0].data();if(e.imageUrl&&e.imageUrl.includes("firebase"))try{let s=(0,M.c7)(),t=(0,M.KR)(s,e.imageUrl);await (0,M.XR)(t)}catch(e){console.error("Error deleting image:",e)}}await (0,E.kd)((0,E.H9)(S.db,"users",i,"menu",e)),$("ลบเมนูสำเร็จ","success"),Q(i)}catch(e){console.error("Error deleting menu item:",e),$("ไม่สามารถลบเมนูได้","error")}finally{c(!1)}},B=async(e,s)=>{if(i)try{await (0,E.mZ)((0,E.H9)(S.db,"users",i,"menu",e),{isAvailable:!s,updatedAt:(0,E.O5)()}),$("อัปเดตสถานะสำเร็จ","success"),Q(i)}catch(e){console.error("Error toggling availability:",e),$("ไม่สามารถอัปเดตสถานะได้","error")}},X=async(e,s)=>{if(i)try{await (0,E.mZ)((0,E.H9)(S.db,"users",i,"menu",e),{isRecommended:!s,updatedAt:(0,E.O5)()}),$("อัปเดตสถานะสำเร็จ","success"),Q(i)}catch(e){console.error("Error toggling recommended status:",e),$("ไม่สามารถอัปเดตสถานะได้","error")}},W=()=>{O({name:"",description:"",price:"",category:"",isAvailable:!0,isRecommended:!1,imageUrl:"",imageFile:null}),L(null)},V=e=>{L(e),O({name:e.name,description:e.description||"",price:e.price.toString(),category:e.category||"",isAvailable:e.isAvailable,isRecommended:e.isRecommended,imageUrl:e.imageUrl||"",imageFile:null}),H(!0)},Y=e=>{let{name:s,value:t,type:r}=e.target;if("checkbox"===r){let t=e.target;O({...J,[s]:t.checked})}else O({...J,[s]:t})},$=(e,s)=>{x({show:!0,message:e,type:s}),setTimeout(()=>{x({show:!1,message:"",type:""})},3e3)},ee=e.filter(e=>{let s=e.name.toLowerCase().includes(u.toLowerCase())||e.description.toLowerCase().includes(u.toLowerCase()),t="all"===p||e.category===p;return s&&t}),es=e=>{j===e?N("asc"===f?"desc":"asc"):(y(e),N("asc")),i&&Q(i)};return(0,r.jsxs)("div",{className:"container mx-auto px-4 py-6",children:[(0,r.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-1",children:"จัดการเมนู"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:(null==d?void 0:d.storeName)?"ร้าน ".concat(d.storeName):"เพิ่มเมนูของร้านคุณ"})]}),(0,r.jsxs)("button",{onClick:()=>{W(),H(!0)},className:"mt-4 md:mt-0 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center",children:[(0,r.jsx)(l.A,{className:"h-4 w-4 mr-2"}),"เพิ่มเมนูใหม่"]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[(0,r.jsx)("div",{className:"p-4 border-b border-gray-200",children:(0,r.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,r.jsxs)("div",{className:"relative flex-1",children:[(0,r.jsx)(F.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,r.jsx)("input",{type:"text",placeholder:"ค้นหาเมนู...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:u,onChange:e=>h(e.target.value)})]}),(0,r.jsx)("div",{className:"flex gap-2",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(_.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,r.jsxs)("select",{className:"pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:p,onChange:e=>b(e.target.value),children:[(0,r.jsx)("option",{value:"all",children:"ทุกหมวดหมู่"}),v.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]})]})})]})}),t&&0===e.length?(0,r.jsx)("div",{className:"flex justify-center items-center p-8",children:(0,r.jsx)(A.A,{className:"h-8 w-8 text-blue-500 animate-spin"})}):0===e.length?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 px-4 text-center",children:[(0,r.jsx)("div",{className:"bg-gray-100 p-4 rounded-full mb-4",children:(0,r.jsx)(l.A,{className:"h-8 w-8 text-gray-400"})}),(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"ยังไม่มีเมนู"}),(0,r.jsx)("p",{className:"text-sm text-gray-500 max-w-md mb-6",children:"เพิ่มเมนูอาหารของร้านคุณเพื่อให้ลูกค้าสั่งได้"})]}):(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>es("name"),children:(0,r.jsxs)("div",{className:"flex items-center",children:["เมนู","name"===j&&(0,r.jsx)(U.A,{className:"ml-1 h-4 w-4 text-gray-400"})]})}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>es("price"),children:(0,r.jsxs)("div",{className:"flex items-center",children:["ราคา","price"===j&&(0,r.jsx)(U.A,{className:"ml-1 h-4 w-4 text-gray-400"})]})}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>es("category"),children:(0,r.jsxs)("div",{className:"flex items-center",children:["หมวดหมู่","category"===j&&(0,r.jsx)(U.A,{className:"ml-1 h-4 w-4 text-gray-400"})]})}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"สถานะ"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"แนะนำ"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"จัดการ"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:ee.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex items-center",children:[e.imageUrl?(0,r.jsx)("img",{src:e.imageUrl||"/placeholder.svg",alt:e.name,className:"w-10 h-10 rounded-md object-cover mr-3"}):(0,r.jsx)("div",{className:"w-10 h-10 rounded-md bg-gray-200 flex items-center justify-center mr-3",children:(0,r.jsx)("span",{className:"text-xs text-gray-500",children:"ไม่มีรูป"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),e.description&&(0,r.jsx)("div",{className:"text-xs text-gray-500 max-w-xs truncate",children:e.description})]})]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"text-sm text-gray-900",children:["฿",e.price.toFixed(2)]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-gray-900",children:e.category||"-"})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("button",{onClick:()=>B(e.id,e.isAvailable),className:"px-2 py-1 rounded-full text-xs font-medium ".concat(e.isAvailable?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.isAvailable?"พร้อมขาย":"หมด"})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("button",{onClick:()=>X(e.id,e.isRecommended),className:"px-2 py-1 rounded-full text-xs font-medium ".concat(e.isRecommended?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:e.isRecommended?"แนะนำ":"ไม่แนะนำ"})}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[(0,r.jsx)("button",{onClick:()=>V(e),className:"text-blue-600 hover:text-blue-900 mr-3",children:"แก้ไข"}),(0,r.jsx)("button",{onClick:()=>Z(e.id),className:"text-red-600 hover:text-red-900",children:"ลบ"})]})]},e.id))})]})})]}),P&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:(0,r.jsx)("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h3",{className:"text-xl font-bold",children:D?"แก้ไขเมนู":"เพิ่มเมนูใหม่"}),(0,r.jsx)("button",{className:"text-gray-500 hover:text-gray-700",onClick:()=>H(!1),children:(0,r.jsx)(g.A,{className:"h-5 w-5"})})]}),(0,r.jsx)("div",{className:"grid grid-cols-1 gap-6",children:(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ชื่อเมนู *"}),(0,r.jsx)("input",{type:"text",name:"name",value:J.name,onChange:Y,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"ชื่อเมนู",required:!0})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ราคา (บาท) *"}),(0,r.jsx)("input",{type:"number",name:"price",value:J.price,onChange:Y,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00",min:"0",step:"0.01",required:!0})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"หมวดหมู่"}),(0,r.jsxs)("select",{name:"category",value:J.category,onChange:Y,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"",disabled:!0,children:"เลือกหมวดหมู่"}),(0,r.jsx)("option",{value:"อาหารจานเดียว",children:"อาหารจานเดียว"}),(0,r.jsx)("option",{value:"กับข้าว",children:"กับข้าว"}),(0,r.jsx)("option",{value:"เครื่องดื่ม",children:"เครื่องดื่ม"}),(0,r.jsx)("option",{value:"ของหวาน",children:"ของหวาน"}),(0,r.jsx)("option",{value:"อื่นๆ",children:"อื่นๆ"}),v.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"รายละเอียด"}),(0,r.jsx)("textarea",{name:"description",value:J.description,onChange:Y,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"รายละเอียดเมนู",rows:3})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"รูปภาพเมนู"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsx)("div",{children:J.imageUrl?(0,r.jsxs)("div",{className:"relative w-full h-40 border rounded-md overflow-hidden",children:[(0,r.jsx)("img",{src:J.imageUrl||"/placeholder.svg",alt:"รูปภาพเมนู",className:"w-full h-full object-cover"}),(0,r.jsx)("button",{type:"button",onClick:()=>O({...J,imageUrl:"",imageFile:null}),className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600",children:(0,r.jsx)(g.A,{className:"h-4 w-4"})})]}):(0,r.jsxs)("label",{className:"cursor-pointer flex flex-col items-center justify-center w-full h-40 border-2 border-dashed border-gray-300 rounded-md hover:bg-gray-50",children:[(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[(0,r.jsx)("svg",{className:"w-10 h-10 text-gray-400 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),(0,r.jsx)("p",{className:"mb-2 text-sm text-gray-500",children:(0,r.jsx)("span",{className:"font-semibold",children:"อัพโหลดรูป"})}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"PNG, JPG หรือ GIF (สูงสุด 10MB)"})]}),(0,r.jsx)("input",{type:"file",accept:"image/*",className:"hidden",onChange:e=>{if(e.target.files&&e.target.files[0]){let s=e.target.files[0];O({...J,imageFile:s});let t=new FileReader;t.onload=e=>{var s;(null==(s=e.target)?void 0:s.result)&&O(s=>{var t;return{...s,imageUrl:null==(t=e.target)?void 0:t.result}})},t.readAsDataURL(s)}}})]})}),(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",id:"isAvailable",name:"isAvailable",checked:J.isAvailable,onChange:e=>O({...J,isAvailable:e.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,r.jsx)("label",{htmlFor:"isAvailable",className:"ml-2 text-sm text-gray-700",children:"พร้อมขาย"})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",id:"isRecommended",name:"isRecommended",checked:J.isRecommended,onChange:e=>O({...J,isRecommended:e.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,r.jsx)("label",{htmlFor:"isRecommended",className:"ml-2 text-sm text-gray-700",children:"แนะนำ"})]})]})})]})]})]})}),(0,r.jsxs)("div",{className:"mt-6 flex justify-end space-x-3",children:[(0,r.jsx)("button",{type:"button",className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700",onClick:()=>H(!1),children:"ยกเลิก"}),(0,r.jsx)("button",{type:"button",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center",onClick:D?K:I,disabled:t,children:t?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(A.A,{className:"h-4 w-4 mr-2 animate-spin"}),"กำลังบันทึก..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(k.A,{className:"h-4 w-4 mr-2"}),D?"อัปเดต":"บันทึก"]})})]})]})})}),m.show&&(0,r.jsx)("div",{className:"fixed bottom-4 right-4 px-6 py-3 rounded-lg shadow-lg z-50 ".concat("success"===m.type?"bg-green-500":"bg-red-500"," text-white"),children:m.message})]})}var L=t(5196),P=t(3109),H=t(3904);function J(){let[e,s]=(0,a.useState)([]),[t,l]=(0,a.useState)(!1),[c,d]=(0,a.useState)("all"),[n,i]=(0,a.useState)(null),[m,x]=(0,a.useState)(""),[u,h]=(0,a.useState)({show:!1,message:"",type:""}),p=(0,C.useRouter)();(0,a.useEffect)(()=>{let e=(0,R.hg)(S.j2,e=>{e?i(e.uid):p.push("/login")});return()=>e()},[p]),(0,a.useEffect)(()=>{if(n){let e=b(n);return()=>e&&e()}},[c,n]);let b=e=>{try{let t;l(!0);let r=new Date;return r.setHours(0,0,0,0),t="all"!==c?(0,E.P)((0,E.rJ)(S.db,"users",e,"orders"),(0,E._M)("status","==",c),(0,E._M)("createdAt",">=",r),(0,E.My)("createdAt","desc")):(0,E.P)((0,E.rJ)(S.db,"users",e,"orders"),(0,E._M)("createdAt",">=",r),(0,E.My)("createdAt","desc")),(0,E.aQ)(t,e=>{let t=[];e.forEach(e=>{let s=e.data();t.push({id:e.id,...s})}),s(t),l(!1)},e=>{console.error("Error in orders real-time listener:",e),y("ไม่สามารถโหลดข้อมูลออเดอร์ได้","error"),l(!1)})}catch(e){return console.error("Error setting up orders listener:",e),y("ไม่สามารถโหลดข้อมูลออเดอร์ได้","error"),l(!1),()=>{}}},j=async(e,s)=>{if(n)try{l(!0);let t=(0,E.H9)(S.db,"users",n,"orders",e);await (0,E.mZ)(t,{status:s,updatedAt:(0,E.O5)()}),y('อัปเดตสถานะออเดอร์เป็น "'.concat(s,'" สำเร็จ'),"success")}catch(e){console.error("Error updating order status:",e),y("ไม่สามารถอัปเดตสถานะออเดอร์ได้","error")}finally{l(!1)}},y=(e,s)=>{h({show:!0,message:e,type:s}),setTimeout(()=>{h({show:!1,message:"",type:""})},3e3)},f=e=>{switch(e){case"pending":return(0,r.jsx)("span",{className:"bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full text-xs",children:"รอยืนยัน"});case"cooking":return(0,r.jsx)("span",{className:"bg-orange-100 text-orange-800 px-2 py-1 rounded-full text-xs",children:"กำลังปรุง"});case"served":return(0,r.jsx)("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs",children:"เสิร์ฟแล้ว"});case"completed":return(0,r.jsx)("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs",children:"เสร็จสิ้น"});case"cancelled":return(0,r.jsx)("span",{className:"bg-red-100 text-red-800 px-2 py-1 rounded-full text-xs",children:"ยกเลิก"});default:return(0,r.jsx)("span",{className:"bg-gray-100 text-gray-800 px-2 py-1 rounded-full text-xs",children:e})}},N=e=>{switch(e.status){case"pending":return(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsxs)("button",{className:"px-3 py-1 bg-green-600 text-white text-xs rounded-md flex items-center",onClick:()=>j(e.id,"cooking"),children:[(0,r.jsx)(L.A,{className:"h-3 w-3 mr-1"})," ยืนยัน"]}),(0,r.jsxs)("button",{className:"px-3 py-1 bg-red-600 text-white text-xs rounded-md flex items-center",onClick:()=>j(e.id,"cancelled"),children:[(0,r.jsx)(g.A,{className:"h-3 w-3 mr-1"})," ปฏิเสธ"]})]});case"cooking":return(0,r.jsxs)("button",{className:"px-3 py-1 bg-blue-600 text-white text-xs rounded-md flex items-center",onClick:()=>j(e.id,"served"),children:[(0,r.jsx)(P.A,{className:"h-3 w-3 mr-1"})," เสิร์ฟแล้ว"]});case"served":return(0,r.jsxs)("button",{className:"px-3 py-1 bg-green-600 text-white text-xs rounded-md flex items-center",onClick:()=>j(e.id,"completed"),children:[(0,r.jsx)(L.A,{className:"h-3 w-3 mr-1"})," เสร็จสิ้น"]});default:return null}},v=m?e.filter(e=>e.table.toLowerCase().includes(m.toLowerCase())||e.id.toLowerCase().includes(m.toLowerCase())):e;return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"bg-white p-4 md:p-6 rounded-xl shadow-sm border border-gray-100",children:[(0,r.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6",children:[(0,r.jsx)("h2",{className:"text-lg md:text-xl font-bold mb-4 md:mb-0",children:"จัดการออเดอร์"}),(0,r.jsxs)("div",{className:"w-full md:w-auto flex flex-col md:flex-row space-y-3 md:space-y-0 md:space-x-3",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(F.A,{className:"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,r.jsx)("input",{type:"text",placeholder:"ค้นหาโต๊ะ",className:"pl-9 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 w-full md:w-48",value:m,onChange:e=>x(e.target.value)})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(_.A,{className:"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,r.jsxs)("select",{className:"pl-9 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 w-full appearance-none",value:c,onChange:e=>d(e.target.value),children:[(0,r.jsx)("option",{value:"all",children:"ทั้งหมด"}),(0,r.jsx)("option",{value:"pending",children:"รอยืนยัน"}),(0,r.jsx)("option",{value:"cooking",children:"กำลังปรุง"}),(0,r.jsx)("option",{value:"served",children:"เสิร์ฟแล้ว"}),(0,r.jsx)("option",{value:"completed",children:"เสร็จสิ้น"}),(0,r.jsx)("option",{value:"cancelled",children:"ยกเลิก"})]})]}),(0,r.jsxs)("button",{className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 flex items-center justify-center",onClick:()=>{n&&b(n)},children:[(0,r.jsx)(H.A,{className:"h-4 w-4 mr-2"}),"รีเฟรช"]})]})]}),(0,r.jsx)("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg text-sm text-blue-800",children:(0,r.jsx)("p",{children:'หมายเหตุ: รายได้จะถูกคำนวณเฉพาะออเดอร์ที่มีสถานะ "เสร็จสิ้น" เท่านั้น ออเดอร์ที่ถูกปฏิเสธจะไม่ถูกนับเป็นรายได้'})}),t?(0,r.jsx)("div",{className:"flex justify-center items-center py-20",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500"})}):v.length>0?(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"โต๊ะ"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"รายการ"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ราคารวม"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"เวลา"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"สถานะ"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"การดำเนินการ"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:v.map(e=>{var s,t,a,l,c;return(0,r.jsxs)("tr",{className:"cancelled"===e.status?"bg-gray-50":"",children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:["โต๊ะ ",e.table||"-"]})}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:[(null==(s=e.items)?void 0:s.length)||0," รายการ"]}),(0,r.jsxs)("div",{className:"text-xs text-gray-400 mt-1",children:[null==(t=e.items)?void 0:t.slice(0,2).map((s,t)=>{var a;return(0,r.jsxs)("span",{children:[s.name," x",s.quantity,t<Math.min(1,((null==(a=e.items)?void 0:a.length)||0)-1)?", ":""]},t)}),((null==(a=e.items)?void 0:a.length)||0)>2&&" และอื่นๆ อีก ".concat(e.items.length-2," รายการ")]})]}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,r.jsxs)("div",{className:"text-sm ".concat("cancelled"===e.status?"text-gray-500 line-through":"text-gray-900"),children:["฿",(null==(l=e.totalAmount)?void 0:l.toFixed(2))||"0"]}),"cancelled"===e.status&&(0,r.jsx)("div",{className:"text-xs text-red-500 mt-1",children:"ไม่นับเป็นรายได้"})]}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-gray-500",children:(null==(c=e.createdAt)?void 0:c.toDate)?new Date(e.createdAt.toDate()).toLocaleTimeString("th-TH",{hour:"2-digit",minute:"2-digit"}):"-"})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:f(e.status)}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:N(e)})]},e.id)})})]})}):(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 px-4 text-center",children:[(0,r.jsx)("div",{className:"bg-gray-100 p-4 rounded-full mb-4",children:(0,r.jsx)(o.A,{className:"h-8 w-8 text-gray-400"})}),(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"ยังไม่มีออเดอร์"}),(0,r.jsx)("p",{className:"text-sm text-gray-500 max-w-md mb-6",children:"ออเดอร์ใหม่จะปรากฏที่นี่เมื่อลูกค้าสั่งอาหาร"})]})]}),u.show&&(0,r.jsx)("div",{className:"fixed bottom-4 right-4 px-6 py-3 rounded-lg shadow-lg z-50 ".concat("success"===u.type?"bg-green-500":"bg-red-500"," text-white"),children:u.message})]})}var O=t(2583);function z(){let[e,s]=(0,a.useState)("overview"),[t,F]=(0,a.useState)(!1),[_,U]=(0,a.useState)(!1),[M,L]=(0,a.useState)(!1),[P,H]=(0,a.useState)(null),[z,G]=(0,a.useState)({restaurantName:"",phoneNumber:"",email:"",storeName:"",phone:""}),[q,Q]=(0,a.useState)({show:!1,message:"",type:""}),T=(0,C.useRouter)(),[I,K]=(0,a.useState)([]),[Z,B]=(0,a.useState)([]),[X,W]=(0,a.useState)(0),[V,Y]=(0,a.useState)(0),[$,ee]=(0,a.useState)([]),[es,et]=(0,a.useState)(!1),[er,ea]=(0,a.useState)(!1),[el,ec]=(0,a.useState)(0),ed=(0,a.useRef)(null);(0,a.useEffect)(()=>{let e=(0,R.hg)(S.j2,e=>{e?(H(e),ei(e.uid),en(e.uid)):T.push("/login")});return()=>e()},[T]);let en=e=>{let s=(0,E.P)((0,E.rJ)(S.db,"users",e,"menu"),(0,E._M)("isRecommended","==",!0),(0,E._M)("isAvailable","==",!0)),t=(0,E.aQ)(s,e=>{let s=[];e.forEach(e=>{s.push({id:e.id,...e.data()})}),K(s)},e=>{console.error("Error in menu real-time listener:",e)}),r=new Date;r.setHours(0,0,0,0);let a=(0,E.P)((0,E.rJ)(S.db,"users",e,"orders"),(0,E._M)("status","==","pending")),l=(0,E.aQ)(a,e=>{let s=[];e.forEach(e=>{s.push({id:e.id,...e.data()})}),B(s)},e=>{console.error("Error in orders real-time listener:",e)}),c=(0,E.P)((0,E.rJ)(S.db,"users",e,"orders"),(0,E._M)("createdAt",">=",r),(0,E._M)("status","==","completed")),d=(0,E.aQ)(c,e=>{let s=0,t=0;e.forEach(e=>{let r=e.data();s+=r.totalAmount||0,t++}),W(s),Y(t)},e=>{console.error("Error in revenue real-time listener:",e)}),n=async()=>{try{let s=new Date;s.setDate(s.getDate()-7);let t=(0,E.P)((0,E.rJ)(S.db,"users",e,"orders"),(0,E._M)("status","==","completed"),(0,E._M)("createdAt",">=",s),(0,E.My)("createdAt","asc")),r=(await (0,E.GG)(t)).docs.reduce((e,s)=>{var t;let r=s.data(),a=(null==(t=r.createdAt)?void 0:t.toDate)?new Date(r.createdAt.toDate()).toISOString().split("T")[0]:new Date().toISOString().split("T")[0];return e[a]||(e[a]=0),e[a]+=r.totalAmount||0,e},{}),a=Object.entries(r).map(e=>{let[s,t]=e;return{date:s,amount:t}});ee(a)}catch(e){console.error("Error fetching weekly revenue:",e)}};n();let i=setInterval(n,36e5);return()=>{t(),l(),d(),clearInterval(i)}},ei=async e=>{try{L(!0);let s=(0,E.H9)(S.db,"users",e);return(0,E.aQ)(s,e=>{if(e.exists()){let s=e.data();G({restaurantName:s.restaurantName||"",phoneNumber:s.phoneNumber||"",email:s.email||"",storeName:s.storeName||"",phone:s.phone||""})}L(!1)},e=>{console.error("Error in profile real-time listener:",e),ex("ไม่สามารถโหลดข้อมูลโปรไฟล์ได้","error"),L(!1)})}catch(e){return console.error("Error fetching user profile:",e),ex("ไม่สามารถโหลดข้อมูลโปรไฟล์ได้","error"),L(!1),()=>{}}},eo=async()=>{if(P)try{L(!0);let e=(0,E.H9)(S.db,"users",P.uid);await (0,E.mZ)(e,{restaurantName:z.restaurantName,phoneNumber:z.phoneNumber,storeName:z.storeName,phone:z.phone,updatedAt:(0,E.O5)()}),ex("อัปเดตข้อมูลโปรไฟล์สำเร็จ","success"),U(!1)}catch(e){console.error("Error updating profile:",e),ex("ไม่สามารถอัปเดตข้อมูลโปรไฟล์ได้","error")}finally{L(!1)}},em=async()=>{try{await (0,R.CI)(S.j2),T.push("/login")}catch(e){console.error("Error signing out:",e)}},ex=(e,s)=>{Q({show:!0,message:e,type:s}),setTimeout(()=>{Q({show:!1,message:"",type:""})},3e3)},eu=e=>{let{name:s,value:t}=e.target;G(e=>({...e,[s]:t}))};(0,a.useEffect)(()=>(ed.current=new Audio("/notification.mp3"),()=>{ed.current&&(ed.current=null)}),[]),(0,a.useEffect)(()=>{Z.length>el&&el>0&&(ed.current&&ed.current.play().catch(e=>console.error("Error playing notification sound:",e)),ex("มีออเดอร์ใหม่ ".concat(Z.length-el," รายการ"),"success")),ec(Z.length)},[Z.length]),(0,a.useEffect)(()=>{let e=e=>{e.ctrlKey&&e.shiftKey&&"D"===e.key&&(e.preventDefault(),ea(e=>!e))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]);let eh=(e,s,t)=>(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 px-4 text-center",children:[(0,r.jsx)("div",{className:"bg-gray-100 p-4 rounded-full mb-4",children:t}),(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:e}),(0,r.jsx)("p",{className:"text-sm text-gray-500 max-w-md mb-6",children:s}),(0,r.jsxs)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center",children:[(0,r.jsx)(l.A,{className:"h-4 w-4 mr-2"}),"เพิ่มข้อมูล"]})]}),ep=e=>{let{data:s}=e;if(!s||0===s.length)return null;let t=Math.max(...s.map(e=>e.amount));return(0,r.jsxs)("div",{className:"relative h-64 w-full mt-4",children:[(0,r.jsx)("div",{className:"flex items-end justify-between h-full w-full",children:s.map((e,s)=>{let a=e.amount/t*200||0,l=new Date(e.date).toLocaleDateString("th-TH",{day:"numeric",month:"short"});return(0,r.jsxs)("div",{className:"flex flex-col items-center",style:{flex:"1"},children:[(0,r.jsx)("div",{className:"bg-blue-500 rounded-t-sm w-12 transition-all duration-500 ease-in-out",style:{height:"".concat(a,"px")},title:"฿".concat(e.amount.toFixed(2))}),(0,r.jsx)("div",{className:"text-xs text-gray-600 mt-2 rotate-45 origin-left",children:l})]},s)})}),(0,r.jsxs)("div",{className:"absolute left-0 top-0 h-full flex flex-col justify-between text-xs text-gray-500",children:[(0,r.jsxs)("span",{children:["฿",t.toFixed(0)]}),(0,r.jsxs)("span",{children:["฿",(t/2).toFixed(0)]}),(0,r.jsx)("span",{children:"฿0"})]})]})};return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[(0,r.jsx)("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-20 md:hidden",children:(0,r.jsxs)("div",{className:"flex items-center justify-between px-4 py-3",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("button",{className:"text-gray-500 hover:text-gray-700 mr-2",onClick:()=>F(!0),children:(0,r.jsx)(h.A,{className:"h-6 w-6"})}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"h-8 w-8 rounded-md bg-blue-600 flex items-center justify-center text-white mr-2",children:(0,r.jsx)(d.A,{className:"h-5 w-5"})}),(0,r.jsx)("h1",{className:"text-lg font-bold",children:z.storeName||"ร้านอาหาร"})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("button",{className:"text-gray-500 hover:text-gray-700",children:(0,r.jsx)(p.A,{className:"h-6 w-6"})}),Z.length>0&&(0,r.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs font-medium px-1.5 py-0.5 rounded-full",children:Z.length})]}),(0,r.jsx)("button",{onClick:()=>U(!0),children:(0,r.jsx)("img",{src:"/placeholder.svg?height=32&width=32",alt:"Profile",className:"h-8 w-8 rounded-full object-cover"})})]})]})}),t&&(0,r.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 z-20 md:hidden",onClick:()=>F(!1)}),(0,r.jsxs)("div",{className:"bg-white border-r border-gray-200 w-64 fixed inset-y-0 left-0 z-30 transition-transform duration-300 ease-in-out transform ".concat(t?"translate-x-0":"-translate-x-full"," md:translate-x-0"),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"h-8 w-8 rounded-md bg-blue-600 flex items-center justify-center text-white mr-2",children:(0,r.jsx)(d.A,{className:"h-5 w-5"})}),(0,r.jsx)("h1",{className:"text-xl font-bold",children:z.storeName||"ร้านอาหาร"})]}),(0,r.jsx)("button",{className:"md:hidden text-gray-500 hover:text-gray-700",onClick:()=>F(!1),children:(0,r.jsx)(g.A,{className:"h-5 w-5"})})]}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("button",{className:"w-full flex items-center px-3 py-2 rounded-md ".concat("overview"===e?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-100"),onClick:()=>{s("overview"),F(!1)},children:[(0,r.jsx)(n.A,{className:"h-5 w-5 mr-3"}),(0,r.jsx)("span",{children:"ภาพรวม"})]}),(0,r.jsxs)("button",{className:"w-full flex items-center justify-between px-3 py-2 rounded-md ".concat("orders"===e?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-100"),onClick:()=>{s("orders"),F(!1)},children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(o.A,{className:"h-5 w-5 mr-3"}),(0,r.jsx)("span",{children:"ออเดอร์"})]}),Z.length>0&&(0,r.jsx)("span",{className:"bg-red-500 text-white text-xs font-medium px-2 py-0.5 rounded-full",children:Z.length})]}),(0,r.jsxs)("button",{className:"w-full flex items-center px-3 py-2 rounded-md ".concat("menu"===e?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-100"),onClick:()=>{s("menu"),F(!1)},children:[(0,r.jsx)(d.A,{className:"h-5 w-5 mr-3"}),(0,r.jsx)("span",{children:"เมนู"})]}),(0,r.jsxs)("button",{className:"w-full flex items-center px-3 py-2 rounded-md ".concat("tables"===e?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-100"),onClick:()=>{s("tables"),F(!1)},children:[(0,r.jsx)(u.A,{className:"h-5 w-5 mr-3"}),(0,r.jsx)("span",{children:"โต๊ะ"})]}),(0,r.jsxs)("button",{className:"w-full flex items-center px-3 py-2 rounded-md ".concat("qrcode"===e?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-100"),onClick:()=>{s("qrcode"),F(!1)},children:[(0,r.jsx)(b.A,{className:"h-5 w-5 mr-3"}),(0,r.jsx)("span",{children:"QR Code"})]}),(0,r.jsxs)("button",{className:"w-full flex items-center px-3 py-2 rounded-md ".concat("revenue"===e?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-100"),onClick:()=>{s("revenue"),F(!1)},children:[(0,r.jsx)(c.A,{className:"h-5 w-5 mr-3"}),(0,r.jsx)("span",{children:"รายได้"})]})]}),(0,r.jsxs)("div",{className:"mt-8",children:[(0,r.jsx)("p",{className:"px-3 text-xs font-medium text-gray-400 uppercase mb-2",children:"บัญชี"}),(0,r.jsxs)("button",{className:"w-full flex items-center px-3 py-2 rounded-md text-gray-700 hover:bg-gray-100",onClick:()=>{U(!0),F(!1)},children:[(0,r.jsx)(j.A,{className:"h-5 w-5 mr-3"}),(0,r.jsx)("span",{children:"ตั้งค่าโปรไฟล์"})]}),(0,r.jsxs)("button",{className:"w-full flex items-center px-3 py-2 rounded-md text-gray-700 hover:bg-gray-100",onClick:em,children:[(0,r.jsx)(y.A,{className:"h-5 w-5 mr-3"}),(0,r.jsx)("span",{children:"ออกจากระบบ"})]})]})]})]}),(0,r.jsxs)("div",{className:"flex-1 md:ml-64",children:[(0,r.jsx)("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-10 hidden md:block",children:(0,r.jsxs)("div",{className:"flex items-center justify-between px-6 py-3",children:[(0,r.jsx)("h2",{className:"text-lg font-bold",children:(e=>{switch(e){case"overview":return"ภาพรวม";case"qrcode":return"สร้าง QR Code";case"orders":return"ออเดอร์";case"revenue":return"รายได้";case"recommended":return"เมนูแนะนำ";case"tables":return"จัดการโต๊ะ";case"menu":return"จัดการเมนู";default:return""}})(e)}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("button",{className:"text-gray-500 hover:text-gray-700",children:(0,r.jsx)(p.A,{className:"h-6 w-6"})}),Z.length>0&&(0,r.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs font-medium px-1.5 py-0.5 rounded-full",children:Z.length})]}),(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsxs)("button",{className:"flex items-center space-x-2 focus:outline-none",onClick:()=>U(!0),children:[(0,r.jsx)("img",{src:"/placeholder.svg?height=32&width=32",alt:"Profile",className:"h-8 w-8 rounded-full object-cover"}),(0,r.jsxs)("div",{className:"hidden md:block text-left",children:[(0,r.jsx)("p",{className:"text-sm font-medium",children:z.storeName||"ร้านอาหารของคุณ"}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:z.phone||z.phoneNumber||"เบอร์โทรศัพท์"})]}),(0,r.jsx)(f.A,{className:"h-4 w-4 text-gray-500"})]})})]})]})}),(0,r.jsxs)("main",{className:"p-4 md:p-6",children:[(()=>{switch(e){case"overview":return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6",children:[(0,r.jsx)("div",{className:"bg-white p-4 md:p-6 rounded-xl shadow-sm border border-gray-100",children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"รายได้วันนี้"}),(0,r.jsxs)("h3",{className:"text-xl md:text-2xl font-bold mt-1",children:["฿",X.toFixed(2)]})]}),(0,r.jsx)("div",{className:"p-2 bg-green-50 rounded-lg",children:(0,r.jsx)(c.A,{className:"h-5 w-5 md:h-6 md:w-6 text-green-500"})})]})}),(0,r.jsx)("div",{className:"bg-white p-4 md:p-6 rounded-xl shadow-sm border border-gray-100",children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"จำนวนออเดอร์ที่เสร็จสิ้น"}),(0,r.jsx)("h3",{className:"text-xl md:text-2xl font-bold mt-1",children:V})]}),(0,r.jsx)("div",{className:"p-2 bg-blue-50 rounded-lg",children:(0,r.jsx)(d.A,{className:"h-5 w-5 md:h-6 md:w-6 text-blue-500"})})]})}),(0,r.jsx)("div",{className:"bg-white p-4 md:p-6 rounded-xl shadow-sm border border-gray-100",children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"มูลค่าเฉลี่ยต่อออเดอร์"}),(0,r.jsxs)("h3",{className:"text-xl md:text-2xl font-bold mt-1",children:["฿",V>0?(X/V).toFixed(2):"0.00"]})]}),(0,r.jsx)("div",{className:"p-2 bg-purple-50 rounded-lg",children:(0,r.jsx)(n.A,{className:"h-5 w-5 md:h-6 md:w-6 text-purple-500"})})]})}),(0,r.jsx)("div",{className:"bg-white p-4 md:p-6 rounded-xl shadow-sm border border-gray-100",children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"ออเดอร์ที่รอยืนยัน"}),(0,r.jsx)("h3",{className:"text-xl md:text-2xl font-bold mt-1",children:Z.length})]}),(0,r.jsx)("div",{className:"p-2 bg-amber-50 rounded-lg",children:(0,r.jsx)(i.A,{className:"h-5 w-5 md:h-6 md:w-6 text-amber-500"})})]})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,r.jsxs)("div",{className:"lg:col-span-2 bg-white p-4 md:p-6 rounded-xl shadow-sm border border-gray-100",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6",children:[(0,r.jsx)("h3",{className:"font-bold mb-2 sm:mb-0",children:"รายได้"}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("button",{className:"text-xs md:text-sm px-3 py-1 bg-blue-50 text-blue-600 rounded-md",children:"7 วัน"}),(0,r.jsx)("button",{className:"text-xs md:text-sm px-3 py-1 text-gray-500 rounded-md",children:"30 วัน"})]})]}),$.length>0?(0,r.jsx)(ep,{data:$}):eh("ยังไม่มีข้อมูลรายได้","รายได้จะแสดงเมื่อมีออเดอร์ที่เสร็จสิ้นแล้วเท่านั้น",(0,r.jsx)(n.A,{className:"h-8 w-8 text-gray-400"}))]}),(0,r.jsxs)("div",{className:"bg-white p-4 md:p-6 rounded-xl shadow-sm border border-gray-100",children:[(0,r.jsx)("h3",{className:"font-bold mb-4",children:"ออเดอร์ที่รอการยืนยัน"}),Z.length>0?(0,r.jsx)("div",{className:"space-y-3",children:Z.map(e=>{var t,a;return(0,r.jsxs)("div",{className:"border border-gray-200 rounded-lg p-3",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,r.jsxs)("span",{className:"font-medium",children:["โต๊ะ ",e.table||"-"]}),(0,r.jsx)("span",{className:"bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full text-xs",children:"รอยืนยัน"})]}),(0,r.jsxs)("p",{className:"text-sm text-gray-500 mb-2",children:[(null==(t=e.items)?void 0:t.length)||0," รายการ \xb7 ฿",(null==(a=e.totalAmount)?void 0:a.toFixed(2))||"0"]}),(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsx)("button",{className:"px-3 py-1 bg-blue-600 text-white text-xs rounded-md",onClick:()=>s("orders"),children:"ดูรายละเอียด"})})]},e.id)})}):eh("ไม่มีออเดอร์ที่รอการยืนยัน","ออเดอร์ใหม่จะปรากฏที่นี่เมื่อลูกค้าสั่งอาหาร",(0,r.jsx)(o.A,{className:"h-8 w-8 text-gray-400"}))]})]}),(0,r.jsxs)("div",{className:"bg-white p-4 md:p-6 rounded-xl shadow-sm border border-gray-100",children:[(0,r.jsx)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6",children:(0,r.jsx)("h3",{className:"font-bold mb-2 sm:mb-0",children:"เมนูแนะนำ"})}),I.length>0?(0,r.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:I.map(e=>{var s;return(0,r.jsxs)("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[(0,r.jsx)("div",{className:"h-32 bg-gray-100",children:e.imageUrl?(0,r.jsx)("img",{src:e.imageUrl||"/placeholder.svg",alt:e.name,className:"w-full h-full object-cover"}):(0,r.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,r.jsx)(d.A,{className:"h-8 w-8 text-gray-400"})})}),(0,r.jsxs)("div",{className:"p-3",children:[(0,r.jsx)("h4",{className:"font-medium text-gray-900",children:e.name}),(0,r.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,r.jsxs)("span",{className:"text-blue-600 font-medium",children:["฿",null==(s=e.price)?void 0:s.toFixed(2)]}),(0,r.jsx)("span",{className:"text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full",children:"แนะนำ"})]})]})]},e.id)})}):eh("ยังไม่มีเมนูแนะนำ","เพิ่มเมนูแนะนำเพื่อแสดงที่นี่",(0,r.jsx)(m.A,{className:"h-8 w-8 text-gray-400"}))]})]});case"qrcode":return(0,r.jsx)(O.default,{});case"orders":return(0,r.jsx)(J,{});case"revenue":return(0,r.jsx)("div",{className:"space-y-6",children:(0,r.jsxs)("div",{className:"bg-white p-4 md:p-6 rounded-xl shadow-sm border border-gray-100",children:[(0,r.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-6",children:[(0,r.jsx)("h2",{className:"text-lg md:text-xl font-bold mb-4 md:mb-0",children:"สรุปรายได้"}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,r.jsx)("button",{className:"px-3 py-1.5 bg-blue-600 text-white text-xs md:text-sm rounded-md",children:"วันนี้"}),(0,r.jsx)("button",{className:"px-3 py-1.5 text-gray-600 text-xs md:text-sm rounded-md",children:"7 วัน"}),(0,r.jsx)("button",{className:"px-3 py-1.5 text-gray-600 text-xs md:text-sm rounded-md",children:"30 วัน"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:"date",className:"pl-3 pr-10 py-1.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-xs md:text-sm"}),(0,r.jsx)(x.A,{className:"h-4 w-4 absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 md:gap-6 mb-8",children:[(0,r.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,r.jsx)("p",{className:"text-xs md:text-sm text-blue-700",children:"รายได้รวม"}),(0,r.jsxs)("h3",{className:"text-xl md:text-2xl font-bold text-blue-900 mt-1",children:["฿",X.toFixed(2)]})]}),(0,r.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg",children:[(0,r.jsx)("p",{className:"text-xs md:text-sm text-green-700",children:"จำนวนออเดอร์"}),(0,r.jsx)("h3",{className:"text-xl md:text-2xl font-bold text-green-900 mt-1",children:V})]}),(0,r.jsxs)("div",{className:"bg-purple-50 p-4 rounded-lg",children:[(0,r.jsx)("p",{className:"text-xs md:text-sm text-purple-700",children:"มูลค่าเฉลี่ยต่อออเดอร์"}),(0,r.jsxs)("h3",{className:"text-xl md:text-2xl font-bold text-purple-900 mt-1",children:["฿",V>0?(X/V).toFixed(2):"0.00"]})]})]}),(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h3",{className:"font-bold mb-4",children:"รายได้ตามช่วงเวลา"}),$.length>0?(0,r.jsx)(ep,{data:$}):eh("ยังไม่มีข้อมูลรายได้","เริ่มรับออเดอร์เพื่อดูข้อมูลรายได้ตามช่วงเวลา",(0,r.jsx)(n.A,{className:"h-8 w-8 text-gray-400"}))]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-bold mb-4",children:"รายได้ตามประเภทเมนู"}),eh("ยังไม่มีข้อมูลรายได้ตามประเภทเมนู","เพิ่มเมนูและเริ่มรับออเดอร์เพื่อดูข้อมูลรายได้ตามประเภทเมนู",(0,r.jsx)(d.A,{className:"h-8 w-8 text-gray-400"}))]})]})});case"tables":return(0,r.jsx)("div",{className:"space-y-6",children:(0,r.jsxs)("div",{className:"bg-white p-4 md:p-6 rounded-xl shadow-sm border border-gray-100",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6",children:[(0,r.jsx)("h2",{className:"text-lg md:text-xl font-bold mb-2 sm:mb-0",children:"จัดการโต๊ะ"}),(0,r.jsxs)("button",{className:"px-3 py-1.5 bg-blue-600 text-white text-xs md:text-sm rounded-md flex items-center",children:[(0,r.jsx)(l.A,{className:"h-4 w-4 mr-1"})," เพิ่มโต๊ะใหม่"]})]}),eh("ยังไม่มีโต๊ะ","เพิ่มโต๊ะเพื่อจัดการที่นั่งและการสั่งอาหารของลูกค้า",(0,r.jsx)(u.A,{className:"h-8 w-8 text-gray-400"}))]})});case"menu":return(0,r.jsx)(D,{});default:return(0,r.jsx)("div",{children:"เลือกเมนูเพื่อดูข้อมูล"})}})(),er&&!1]})]}),_&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:(0,r.jsx)("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h3",{className:"text-xl font-bold",children:"ตั้งค่าโปรไฟล์"}),(0,r.jsx)("button",{className:"text-gray-500 hover:text-gray-700",onClick:()=>U(!1),children:(0,r.jsx)(g.A,{className:"h-5 w-5"})})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{className:"flex justify-center mb-6",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("img",{src:"/placeholder.svg?height=80&width=80",alt:"Profile",className:"h-20 w-20 rounded-full object-cover border-2 border-gray-200"}),(0,r.jsx)("button",{className:"absolute bottom-0 right-0 bg-blue-600 text-white p-1 rounded-full",children:(0,r.jsx)(l.A,{className:"h-4 w-4"})})]})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ชื่อร้านอาหาร"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(N.A,{className:"h-5 w-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,r.jsx)("input",{type:"text",name:"storeName",value:z.storeName,onChange:eu,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"ชื่อร้านอาหารของคุณ"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"เบอร์โทรศัพท์"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(v.A,{className:"h-5 w-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,r.jsx)("input",{type:"tel",name:"phone",value:z.phone,onChange:eu,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"เบอร์โทรศัพท์"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"อีเมล"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(w.A,{className:"h-5 w-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,r.jsx)("input",{type:"email",name:"email",value:z.email,disabled:!0,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md bg-gray-50 cursor-not-allowed"})]}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"ไม่สามารถเปลี่ยนอีเมลได้"})]})]}),(0,r.jsxs)("div",{className:"mt-8 flex justify-end space-x-3",children:[(0,r.jsx)("button",{className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700",onClick:()=>U(!1),children:"ยกเลิก"}),(0,r.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center",onClick:eo,disabled:M,children:M?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(A.A,{className:"h-4 w-4 mr-2 animate-spin"}),"กำลังบันทึก..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(k.A,{className:"h-4 w-4 mr-2"}),"บันทึก"]})})]})]})})}),q.show&&(0,r.jsx)("div",{className:"fixed bottom-4 right-4 px-6 py-3 rounded-lg shadow-lg z-50 ".concat("success"===q.type?"bg-green-500":"bg-red-500"," text-white"),children:q.message})]})}},4907:(e,s,t)=>{Promise.resolve().then(t.bind(t,829))}},e=>{var s=s=>e(e.s=s);e.O(0,[992,122,135,933,712,583,441,684,358],()=>s(4907)),_N_E=e.O()}]);