(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[69],{2056:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>g});var a=t(5155),l=t(2115),r=t(5695),i=t(9946);let d=(0,i.A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);var c=t(7809),n=t(7924),o=t(4616),m=t(4416);let x=(0,i.A)("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);var h=t(3052),u=t(5610),b=t(5317);function p(){let[e,s]=(0,l.useState)([]),[t,i]=(0,l.useState)([]),[p,g]=(0,l.useState)([]),[f,j]=(0,l.useState)("all"),[y,N]=(0,l.useState)(""),[w,v]=(0,l.useState)([]),[k,A]=(0,l.useState)(!1),[C,S]=(0,l.useState)(!0),[q,_]=(0,l.useState)(null),[M,E]=(0,l.useState)(!1),[L,F]=(0,l.useState)(""),I=(0,r.useRouter)(),P=(0,r.useSearchParams)(),z=P.get("id"),G=P.get("table")||"1";(0,l.useEffect)(()=>{if(!z)return void I.push("/");(async()=>{try{S(!0);let e=await (0,b.GG)((0,b.P)((0,b.rJ)(u.db,"users"),(0,b._M)("__name__","==",z)));if(e.empty){console.error("Restaurant not found"),I.push("/");return}let t=e.docs[0].data();_(t);let a=(0,b.P)((0,b.rJ)(u.db,"users",z,"menu"),(0,b._M)("isAvailable","==",!0)),l=await (0,b.GG)(a),r=[],d=new Set;l.forEach(e=>{let s=e.data(),t={id:e.id,...s};r.push(t),s.category&&d.add(s.category)}),s(r),i(r),g(Array.from(d)),S(!1)}catch(e){console.error("Error fetching restaurant data:",e),S(!1)}})()},[z,I]),(0,l.useEffect)(()=>{let s=e;"all"!==f&&(s=s.filter(e=>e.category===f)),y&&(s=s.filter(e=>e.name.toLowerCase().includes(y.toLowerCase())||e.description.toLowerCase().includes(y.toLowerCase()))),i(s)},[f,y,e]);let H=w.reduce((e,s)=>e+s.price*s.quantity,0),J=e=>{v(s=>s.find(s=>s.id===e.id)?s.map(s=>s.id===e.id?{...s,quantity:s.quantity+1}:s):[...s,{...e,quantity:1}])},O=(e,s)=>{if(s<1)return void R(e);v(t=>t.map(t=>t.id===e?{...t,quantity:s}:t))},R=e=>{v(s=>s.filter(s=>s.id!==e))},U=()=>{v([])},W=async()=>{if(z&&0!==w.length)try{S(!0);let e={items:w.map(e=>({id:e.id,name:e.name,price:e.price,quantity:e.quantity})),table:G,status:"pending",totalAmount:H,createdAt:(0,b.O5)()},s=await (0,b.gS)((0,b.rJ)(u.db,"users",z,"orders"),e);F(s.id.slice(-6).toUpperCase()),E(!0),U()}catch(e){console.error("Error submitting order:",e)}finally{S(!1)}};return C&&!M?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):M?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 p-4",children:(0,a.jsxs)("div",{className:"max-w-md mx-auto bg-white rounded-xl shadow-md overflow-hidden p-6 text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"สั่งอาหารสำเร็จ!"}),(0,a.jsxs)("p",{className:"text-gray-600 mb-6",children:["หมายเลขออเดอร์ของคุณคือ #",L]}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-8",children:"กรุณารอสักครู่ ทางร้านกำลังเตรียมอาหารให้คุณ"}),(0,a.jsx)("button",{onClick:()=>{E(!1),window.location.reload()},className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"สั่งอาหารเพิ่มเติม"})]})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50 pb-20",children:[(0,a.jsx)("div",{className:"bg-white shadow-sm",children:(0,a.jsx)("div",{className:"max-w-4xl mx-auto px-4 py-4",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("button",{onClick:()=>I.push("/"),className:"mr-3 p-1 rounded-full hover:bg-gray-100",children:(0,a.jsx)(d,{className:"h-5 w-5 text-gray-500"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-xl font-bold",children:(null==q?void 0:q.storeName)||(null==q?void 0:q.restaurantName)||"ร้านอาหาร"}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["โต๊ะ ",G]})]}),(0,a.jsx)("div",{className:"ml-auto relative",children:(0,a.jsxs)("button",{className:"p-2 rounded-full bg-blue-50 text-blue-600 relative",onClick:()=>A(!0),children:[(0,a.jsx)(c.A,{className:"h-6 w-6"}),w.length>0&&(0,a.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs font-medium px-1.5 py-0.5 rounded-full",children:w.reduce((e,s)=>e+s.quantity,0)})]})})]})})}),(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-4",children:[(0,a.jsxs)("div",{className:"relative mb-4",children:[(0,a.jsx)(n.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),(0,a.jsx)("input",{type:"text",placeholder:"ค้นหาเมนู...",className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",value:y,onChange:e=>N(e.target.value)})]}),(0,a.jsxs)("div",{className:"flex overflow-x-auto pb-2 -mx-1 hide-scrollbar",children:[(0,a.jsx)("button",{className:"whitespace-nowrap px-4 py-2 rounded-full mx-1 text-sm font-medium ".concat("all"===f?"bg-blue-600 text-white":"bg-gray-100 text-gray-800"),onClick:()=>j("all"),children:"ทั้งหมด"}),p.map(e=>(0,a.jsx)("button",{className:"whitespace-nowrap px-4 py-2 rounded-full mx-1 text-sm font-medium ".concat(f===e?"bg-blue-600 text-white":"bg-gray-100 text-gray-800"),onClick:()=>j(e),children:e},e))]})]}),(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-2",children:[(0,a.jsx)("h2",{className:"text-lg font-bold mb-4",children:"all"===f?"เมนูทั้งหมด":f}),0===t.length?(0,a.jsx)("div",{className:"bg-white rounded-lg p-8 text-center",children:(0,a.jsx)("p",{className:"text-gray-500",children:"ไม่พบเมนูที่คุณค้นหา"})}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map(e=>(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden flex",children:[(0,a.jsxs)("div",{className:"flex-1 p-4",children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900",children:e.name}),e.description&&(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-1 line-clamp-2",children:e.description}),(0,a.jsxs)("div",{className:"mt-2 flex items-center justify-between",children:[(0,a.jsxs)("span",{className:"text-blue-600 font-medium",children:["฿",e.price.toFixed(2)]}),(0,a.jsx)("button",{onClick:()=>J(e),className:"p-1 rounded-full bg-blue-50 text-blue-600",children:(0,a.jsx)(o.A,{className:"h-5 w-5"})})]})]}),e.imageUrl&&(0,a.jsx)("div",{className:"w-24 h-24 md:w-32 md:h-32",children:(0,a.jsx)("img",{src:e.imageUrl||"/placeholder.svg",alt:e.name,className:"w-full h-full object-cover"})})]},e.id))})]}),k&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50",children:(0,a.jsxs)("div",{className:"absolute right-0 top-0 bottom-0 w-full max-w-md bg-white shadow-xl flex flex-col",children:[(0,a.jsxs)("div",{className:"p-4 border-b border-gray-200 flex items-center",children:[(0,a.jsx)("button",{onClick:()=>A(!1),className:"p-1 rounded-full hover:bg-gray-100 mr-2",children:(0,a.jsx)(m.A,{className:"h-6 w-6 text-gray-500"})}),(0,a.jsx)("h2",{className:"text-lg font-bold",children:"ตะกร้าของคุณ"})]}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto p-4",children:0===w.length?(0,a.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-center p-4",children:[(0,a.jsx)(c.A,{className:"h-12 w-12 text-gray-300 mb-4"}),(0,a.jsx)("p",{className:"text-gray-500 mb-4",children:"ตะกร้าของคุณว่างเปล่า"}),(0,a.jsx)("button",{onClick:()=>A(!1),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"เลือกเมนู"})]}):(0,a.jsx)("div",{className:"space-y-4",children:w.map(e=>(0,a.jsxs)("div",{className:"flex items-center border-b border-gray-100 pb-4",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"font-medium",children:e.name}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["฿",e.price.toFixed(2)]})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("button",{onClick:()=>O(e.id,e.quantity-1),className:"p-1 rounded-full bg-gray-100",children:(0,a.jsx)(x,{className:"h-4 w-4 text-gray-600"})}),(0,a.jsx)("span",{className:"mx-2 w-6 text-center",children:e.quantity}),(0,a.jsx)("button",{onClick:()=>O(e.id,e.quantity+1),className:"p-1 rounded-full bg-gray-100",children:(0,a.jsx)(o.A,{className:"h-4 w-4 text-gray-600"})})]})]},e.id))})}),w.length>0&&(0,a.jsxs)("div",{className:"p-4 border-t border-gray-200",children:[(0,a.jsxs)("div",{className:"flex justify-between mb-4",children:[(0,a.jsx)("span",{className:"font-medium",children:"รวมทั้งสิ้น"}),(0,a.jsxs)("span",{className:"font-bold",children:["฿",H.toFixed(2)]})]}),(0,a.jsx)("button",{onClick:W,className:"w-full py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center justify-center",disabled:C,children:C?(0,a.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-white"}):(0,a.jsxs)(a.Fragment,{children:["ยืนยันการสั่งอาหาร ",(0,a.jsx)(h.A,{className:"h-5 w-5 ml-1"})]})})]})]})}),w.length>0&&!k&&(0,a.jsx)("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 p-4 shadow-lg",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[w.reduce((e,s)=>e+s.quantity,0)," รายการ"]}),(0,a.jsxs)("p",{className:"font-bold",children:["฿",H.toFixed(2)]})]}),(0,a.jsxs)("button",{onClick:()=>A(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center",children:["ดูตะกร้า ",(0,a.jsx)(h.A,{className:"h-5 w-5 ml-1"})]})]})})]})}function g(){let e=(0,r.useRouter)(),s=(0,r.useSearchParams)().get("id");return((0,l.useEffect)(()=>{s||e.push("/")},[s,e]),s)?(0,a.jsx)(p,{}):(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,a.jsxs)("div",{className:"text-center p-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-2",children:"ไม่พบข้อมูลร้านอาหาร"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"กรุณาสแกน QR Code ใหม่อีกครั้ง"})]})})}},2723:(e,s,t)=>{Promise.resolve().then(t.bind(t,2056))},3052:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(9946).A)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},4416:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(9946).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},4616:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(9946).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},5610:(e,s,t)=>{"use strict";t.d(s,{H9:()=>r.H9,db:()=>n,j2:()=>c,x7:()=>r.x7});var a=t(3915),l=t(6203),r=t(5317),i=t(858);let d=(0,a.Wp)({apiKey:"AIzaSyBdnWr8bkOF5oP2gSsjo9pXbrZbJO-QzDc",authDomain:"fastorder-8f143.firebaseapp.com",projectId:"fastorder-8f143",storageBucket:"fastorder-8f143.firebasestorage.app",messagingSenderId:"827965800193",appId:"1:827965800193:web:1d9ff91b5f6adb90bf6500",measurementId:"G-2LXXJM6W59"}),c=(0,l.xI)(d),n=(0,r.aU)(d);new l.HF,(0,i.c7)(d)},7809:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(9946).A)("shopping-cart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]])},7924:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(9946).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])}},e=>{var s=s=>e(e.s=s);e.O(0,[992,122,135,441,684,358],()=>s(2723)),_N_E=e.O()}]);