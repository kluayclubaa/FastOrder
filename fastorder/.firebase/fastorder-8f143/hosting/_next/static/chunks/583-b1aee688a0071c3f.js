"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[583],{2583:(e,t,n)=>{n.d(t,{default:()=>x});var a=n(5155),r=n(2115),l=n(1857),s=n(1788),o=n(1304),c=n(4357),i=n(6683),d=n(5610),m=n(6203),u=n(5695);function x(){let[e,t]=(0,r.useState)(null),[n,x]=(0,r.useState)(""),[g,h]=(0,r.useState)(""),[p,b]=(0,r.useState)(""),[f,v]=(0,r.useState)(300),[j,y]=(0,r.useState)([]),[w,N]=(0,r.useState)(!1),C=(0,r.useRef)(null),k=(0,u.useRouter)();(0,r.useEffect)(()=>{let e=(0,m.hg)(d.j2,e=>{if(e){t(e.uid);let n=localStorage.getItem("qrcodes_".concat(e.uid));if(n)try{y(JSON.parse(n))}catch(e){console.error("Error parsing saved QR codes",e)}}else k.push("/login")});return()=>e()},[k]);let S=()=>{if(!e||!n)return"";let t=window.location.origin,a=g?"".concat(g).concat(n):n,r="".concat(t,"/order?id=").concat(e,"&table=").concat(a);return p?"".concat(r,"&info=").concat(encodeURIComponent(p)):r};return(0,a.jsxs)("div",{className:"max-w-4xl mx-auto p-4",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-6",children:"สร้าง QR Code สำหรับโต๊ะอาหาร"}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-8",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"โซน (ไม่บังคับ)"}),(0,a.jsxs)("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:g,onChange:e=>h(e.target.value),children:[(0,a.jsx)("option",{value:"",children:"ไม่ระบุโซน"}),(0,a.jsx)("option",{value:"A",children:"โซน A"}),(0,a.jsx)("option",{value:"B",children:"โซน B"}),(0,a.jsx)("option",{value:"C",children:"โซน C"}),(0,a.jsx)("option",{value:"D",children:"โซน D"})]})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"หมายเลขโต๊ะ *"}),(0,a.jsx)("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"เช่น 1, 2, 3",value:n,onChange:e=>x(e.target.value),required:!0})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ข้อมูลเพิ่มเติม (ไม่บังคับ)"}),(0,a.jsx)("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"เช่น ชื่อร้าน, ข้อความต้อนรับ",value:p,onChange:e=>b(e.target.value)})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ขนาด QR Code"}),(0,a.jsxs)("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:f,onChange:e=>v(Number(e.target.value)),children:[(0,a.jsx)("option",{value:"200",children:"เล็ก (200x200 px)"}),(0,a.jsx)("option",{value:"300",children:"กลาง (300x300 px)"}),(0,a.jsx)("option",{value:"400",children:"ใหญ่ (400x400 px)"})]})]}),(0,a.jsx)("button",{onClick:()=>{if(!e||!n)return;let t=S(),a=[{id:Date.now().toString(),table:n,zone:g,url:t,createdAt:new Date},...j];y(a),localStorage.setItem("qrcodes_".concat(e),JSON.stringify(a)),N(!0)},disabled:!n,className:"w-full py-2 rounded-md ".concat(n?"bg-blue-600 hover:bg-blue-700 text-white":"bg-gray-300 cursor-not-allowed"),children:"สร้าง QR Code"})]}),(0,a.jsx)("div",{className:"flex flex-col items-center justify-center",children:w&&(0,a.jsxs)("div",{className:"text-center",ref:C,children:[(0,a.jsxs)("div",{className:"mb-3 font-medium",children:["โต๊ะ ",g,n]}),(0,a.jsx)(l.h,{value:S(),size:f,level:"H",includeMargin:!0,className:"mx-auto"}),(0,a.jsxs)("div",{className:"mt-4 flex flex-wrap justify-center gap-2",children:[(0,a.jsxs)("button",{onClick:()=>{if(!C.current)return;let e=C.current.querySelector("canvas");if(!e){let e=C.current.querySelector("svg");if(!e)return;let t=new XMLSerializer().serializeToString(e),a=document.createElement("canvas"),r=a.getContext("2d"),l=new Image;a.width=f,a.height=f,l.onload=()=>{if(r){r.drawImage(l,0,0);let e=a.toDataURL("image/png"),t=document.createElement("a"),s=g?"".concat(g).concat(n):n;t.download="qrcode-table-".concat(s,".png"),t.href=e,t.click()}},l.src="data:image/svg+xml;base64,".concat(btoa(t));return}let t=e.toDataURL("image/png"),a=document.createElement("a"),r=g?"".concat(g).concat(n):n;a.download="qrcode-table-".concat(r,".png"),a.href=t,a.click()},className:"flex items-center px-3 py-1.5 bg-blue-600 text-white rounded-md text-sm",children:[(0,a.jsx)(s.A,{className:"h-4 w-4 mr-1"})," บันทึก"]}),(0,a.jsxs)("button",{onClick:()=>{var e,t,a;let r=window.open("","_blank");if(!r)return;let l=g?"".concat(g).concat(n):n,s=S();r.document.write("\n      <html>\n        <head>\n          <title>QR Code โต๊ะ ".concat(l,'</title>\n          <style>\n            body {\n              font-family: Arial, sans-serif;\n              text-align: center;\n              padding: 20px;\n            }\n            .qr-container {\n              margin: 20px auto;\n              max-width: 400px;\n            }\n            .table-info {\n              font-size: 24px;\n              font-weight: bold;\n              margin-bottom: 10px;\n            }\n            .instructions {\n              font-size: 16px;\n              margin-bottom: 20px;\n            }\n            img {\n              max-width: 100%;\n              height: auto;\n            }\n            .url {\n              font-size: 12px;\n              word-break: break-all;\n              margin-top: 10px;\n            }\n            @media print {\n              .no-print {\n                display: none;\n              }\n            }\n          </style>\n        </head>\n        <body>\n          <div class="qr-container">\n            <div class="table-info">โต๊ะ ').concat(l,'</div>\n            <div class="instructions">สแกน QR Code เพื่อสั่งอาหาร</div>\n            <div>\n              <img src="').concat((null==(t=C.current)||null==(e=t.querySelector("svg"))?void 0:e.outerHTML)?"data:image/svg+xml;charset=utf-8,"+encodeURIComponent((null==(a=C.current.querySelector("svg"))?void 0:a.outerHTML)||""):"",'" alt="QR Code" />\n            </div>\n            <div class="url">').concat(s,'</div>\n            <button class="no-print" style="margin-top: 20px; padding: 10px 20px;" onclick="window.print()">พิมพ์</button>\n          </div>\n        </body>\n      </html>\n    ')),r.document.close()},className:"flex items-center px-3 py-1.5 bg-green-600 text-white rounded-md text-sm",children:[(0,a.jsx)(o.A,{className:"h-4 w-4 mr-1"})," พิมพ์"]}),(0,a.jsxs)("button",{onClick:()=>{let e=S();navigator.clipboard.writeText(e).then(()=>{alert("คัดลอก URL สำเร็จ")}).catch(e=>{console.error("Error copying URL: ",e)})},className:"flex items-center px-3 py-1.5 bg-purple-600 text-white rounded-md text-sm",children:[(0,a.jsx)(c.A,{className:"h-4 w-4 mr-1"})," คัดลอก URL"]}),(0,a.jsxs)("button",{onClick:()=>{let e=S(),t=g?"".concat(g).concat(n):n;navigator.share?navigator.share({title:"QR Code สำหรับโต๊ะ ".concat(t),text:"สแกน QR Code นี้เพื่อสั่งอาหาร",url:e}).catch(e=>{console.error("Error sharing: ",e)}):alert("ไม่รองรับการแชร์บนอุปกรณ์นี้")},className:"flex items-center px-3 py-1.5 bg-orange-600 text-white rounded-md text-sm",children:[(0,a.jsx)(i.A,{className:"h-4 w-4 mr-1"})," แชร์"]})]})]})})]})}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-bold mb-4",children:"QR Code ที่สร้างล่าสุด"}),0===j.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("div",{className:"bg-gray-100 p-4 rounded-full inline-block mb-4",children:(0,a.jsx)(l.h,{value:"empty",size:40,className:"text-gray-400"})}),(0,a.jsx)("p",{className:"text-gray-500",children:"ยังไม่มี QR Code ที่สร้างไว้"})]}):(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:j.slice(0,6).map(e=>(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 text-center",children:[(0,a.jsxs)("div",{className:"mb-2 font-medium",children:["โต๊ะ ",e.zone,e.table]}),(0,a.jsx)(l.h,{value:e.url,size:150,level:"M",includeMargin:!0,className:"mx-auto"}),(0,a.jsx)("div",{className:"mt-3 text-xs text-gray-500",children:new Date(e.createdAt).toLocaleDateString("th-TH")}),(0,a.jsx)("button",{onClick:()=>{x(e.table),h(e.zone),N(!0)},className:"mt-2 w-full px-3 py-1.5 bg-gray-100 text-gray-700 rounded-md text-sm hover:bg-gray-200",children:"ดูรายละเอียด"})]},e.id))})]})]})}},5610:(e,t,n)=>{n.d(t,{H9:()=>l.H9,db:()=>i,j2:()=>c,x7:()=>l.x7});var a=n(3915),r=n(6203),l=n(5317),s=n(858);let o=(0,a.Wp)({apiKey:"AIzaSyBdnWr8bkOF5oP2gSsjo9pXbrZbJO-QzDc",authDomain:"fastorder-8f143.firebaseapp.com",projectId:"fastorder-8f143",storageBucket:"fastorder-8f143.firebasestorage.app",messagingSenderId:"827965800193",appId:"1:827965800193:web:1d9ff91b5f6adb90bf6500",measurementId:"G-2LXXJM6W59"}),c=(0,r.xI)(o),i=(0,l.aU)(o);new r.HF,(0,s.c7)(o)}}]);